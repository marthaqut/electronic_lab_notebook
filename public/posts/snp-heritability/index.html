<!DOCTYPE html>
<html lang="en">
<head>
  
  <meta charset="utf-8">
  <title>SNP heritability</title>
  <meta name="description" content="SNP heritability">
  <meta name="author" content="Martha Aquino">
  
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <noscript>
    <link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,600" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="/css/fonts.css">
  </noscript>
  
  
  <style type="text/css" media="screen">
    /*!
Pure v1.0.0
Copyright 2013 Yahoo!
Licensed under the BSD License.
https://github.com/yahoo/pure/blob/master/LICENSE.md
*/
/*!
normalize.css v^3.0 | MIT License | git.io/normalize
Copyright (c) Nicolas Gallagher and Jonathan Neal
*/
/*! normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css */img,legend{border:0}legend,td,th{padding:0}html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,optgroup,strong{font-weight:700}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}pre,textarea{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]{-webkit-appearance:textfield;box-sizing:content-box}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}table{border-collapse:collapse;border-spacing:0}.hidden,[hidden]{display:none!important}.pure-img{max-width:100%;height:auto;display:block}
  </style>
  <style type="text/css" media="screen">
    /*!
Pure v1.0.0
Copyright 2013 Yahoo!
Licensed under the BSD License.
https://github.com/yahoo/pure/blob/master/LICENSE.md
*/
.pure-menu{box-sizing:border-box}.pure-menu-fixed{position:fixed;left:0;top:0;z-index:3}.pure-menu-item,.pure-menu-list{position:relative}.pure-menu-list{list-style:none;margin:0;padding:0}.pure-menu-item{padding:0;margin:0;height:100%}.pure-menu-heading,.pure-menu-link{display:block;text-decoration:none;white-space:nowrap}.pure-menu-horizontal{width:100%;white-space:normal}.pure-menu-horizontal .pure-menu-list{display:inline-block}.pure-menu-horizontal .pure-menu-heading,.pure-menu-horizontal .pure-menu-item,.pure-menu-horizontal .pure-menu-separator{display:inline-block;zoom:1;vertical-align:middle}.pure-menu-item .pure-menu-item{display:block}.pure-menu-children{display:none;position:absolute;left:100%;top:0;margin:0;padding:0;z-index:3}.pure-menu-horizontal .pure-menu-children{left:0;top:auto;width:inherit}.pure-menu-active>.pure-menu-children,.pure-menu-allow-hover:hover>.pure-menu-children{display:block;position:absolute}.pure-menu-has-children>.pure-menu-link:after{padding-left:.5em;content:"\25B8";font-size:small}.pure-menu-horizontal .pure-menu-has-children>.pure-menu-link:after{content:"\25BE"}.pure-menu-scrollable{overflow-y:scroll;overflow-x:hidden}.pure-menu-scrollable .pure-menu-list{display:block}.pure-menu-horizontal.pure-menu-scrollable .pure-menu-list{display:inline-block}.pure-menu-horizontal.pure-menu-scrollable{white-space:nowrap;overflow-y:hidden;overflow-x:auto;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;padding:.5em 0}.pure-menu-horizontal.pure-menu-scrollable::-webkit-scrollbar{display:none}.pure-menu-horizontal .pure-menu-children .pure-menu-separator,.pure-menu-separator{background-color:#ccc;height:1px;margin:.3em 0}.pure-menu-horizontal .pure-menu-separator{width:1px;height:1.3em;margin:0 .3em}.pure-menu-horizontal .pure-menu-children .pure-menu-separator{display:block;width:auto}.pure-menu-heading{text-transform:uppercase;color:#565d64}.pure-menu-link{color:#777}.pure-menu-children{background-color:#fff}.pure-menu-disabled,.pure-menu-heading,.pure-menu-link{padding:.5em 1em}.pure-menu-disabled{opacity:.5}.pure-menu-disabled .pure-menu-link:hover{background-color:transparent}.pure-menu-active>.pure-menu-link,.pure-menu-link:focus,.pure-menu-link:hover{background-color:#eee}.pure-menu-selected .pure-menu-link,.pure-menu-selected .pure-menu-link:visited{color:#000}

  </style>
  <style type="text/css" media="screen">
    /*!
Pure v1.0.0
Copyright 2013 Yahoo!
Licensed under the BSD License.
https://github.com/yahoo/pure/blob/master/LICENSE.md
*/
.pure-g{letter-spacing:-.31em;text-rendering:optimizespeed;font-family:FreeSans,Arimo,"Droid Sans",Helvetica,Arial,sans-serif;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-flow:row wrap;-ms-flex-flow:row wrap;flex-flow:row wrap;-webkit-align-content:flex-start;-ms-flex-line-pack:start;align-content:flex-start}@media all and (-ms-high-contrast:none),(-ms-high-contrast:active){table .pure-g{display:block}}.opera-only :-o-prefocus,.pure-g{word-spacing:-.43em}.pure-u,.pure-u-1,.pure-u-1-1,.pure-u-1-12,.pure-u-1-2,.pure-u-1-24,.pure-u-1-3,.pure-u-1-4,.pure-u-1-5,.pure-u-1-6,.pure-u-1-8,.pure-u-10-24,.pure-u-11-12,.pure-u-11-24,.pure-u-12-24,.pure-u-13-24,.pure-u-14-24,.pure-u-15-24,.pure-u-16-24,.pure-u-17-24,.pure-u-18-24,.pure-u-19-24,.pure-u-2-24,.pure-u-2-3,.pure-u-2-5,.pure-u-20-24,.pure-u-21-24,.pure-u-22-24,.pure-u-23-24,.pure-u-24-24,.pure-u-3-24,.pure-u-3-4,.pure-u-3-5,.pure-u-3-8,.pure-u-4-24,.pure-u-4-5,.pure-u-5-12,.pure-u-5-24,.pure-u-5-5,.pure-u-5-6,.pure-u-5-8,.pure-u-6-24,.pure-u-7-12,.pure-u-7-24,.pure-u-7-8,.pure-u-8-24,.pure-u-9-24{display:inline-block;zoom:1;letter-spacing:normal;word-spacing:normal;vertical-align:top;text-rendering:auto}.pure-g [class*=pure-u]{font-family:sans-serif}.pure-u-1-24{width:4.1667%}.pure-u-1-12,.pure-u-2-24{width:8.3333%}.pure-u-1-8,.pure-u-3-24{width:12.5%}.pure-u-1-6,.pure-u-4-24{width:16.6667%}.pure-u-1-5{width:20%}.pure-u-5-24{width:20.8333%}.pure-u-1-4,.pure-u-6-24{width:25%}.pure-u-7-24{width:29.1667%}.pure-u-1-3,.pure-u-8-24{width:33.3333%}.pure-u-3-8,.pure-u-9-24{width:37.5%}.pure-u-2-5{width:40%}.pure-u-10-24,.pure-u-5-12{width:41.6667%}.pure-u-11-24{width:45.8333%}.pure-u-1-2,.pure-u-12-24{width:50%}.pure-u-13-24{width:54.1667%}.pure-u-14-24,.pure-u-7-12{width:58.3333%}.pure-u-3-5{width:60%}.pure-u-15-24,.pure-u-5-8{width:62.5%}.pure-u-16-24,.pure-u-2-3{width:66.6667%}.pure-u-17-24{width:70.8333%}.pure-u-18-24,.pure-u-3-4{width:75%}.pure-u-19-24{width:79.1667%}.pure-u-4-5{width:80%}.pure-u-20-24,.pure-u-5-6{width:83.3333%}.pure-u-21-24,.pure-u-7-8{width:87.5%}.pure-u-11-12,.pure-u-22-24{width:91.6667%}.pure-u-23-24{width:95.8333%}.pure-u-1,.pure-u-1-1,.pure-u-24-24,.pure-u-5-5{width:100%}
  </style>
  
  
  <style type="text/css" media="screen">
    /*!
Pure v1.0.0
Copyright 2013 Yahoo!
Licensed under the BSD License.
https://github.com/yahoo/pure/blob/master/LICENSE.md
*/
@media screen and (min-width:35.5em){.pure-u-sm-1,.pure-u-sm-1-1,.pure-u-sm-1-12,.pure-u-sm-1-2,.pure-u-sm-1-24,.pure-u-sm-1-3,.pure-u-sm-1-4,.pure-u-sm-1-5,.pure-u-sm-1-6,.pure-u-sm-1-8,.pure-u-sm-10-24,.pure-u-sm-11-12,.pure-u-sm-11-24,.pure-u-sm-12-24,.pure-u-sm-13-24,.pure-u-sm-14-24,.pure-u-sm-15-24,.pure-u-sm-16-24,.pure-u-sm-17-24,.pure-u-sm-18-24,.pure-u-sm-19-24,.pure-u-sm-2-24,.pure-u-sm-2-3,.pure-u-sm-2-5,.pure-u-sm-20-24,.pure-u-sm-21-24,.pure-u-sm-22-24,.pure-u-sm-23-24,.pure-u-sm-24-24,.pure-u-sm-3-24,.pure-u-sm-3-4,.pure-u-sm-3-5,.pure-u-sm-3-8,.pure-u-sm-4-24,.pure-u-sm-4-5,.pure-u-sm-5-12,.pure-u-sm-5-24,.pure-u-sm-5-5,.pure-u-sm-5-6,.pure-u-sm-5-8,.pure-u-sm-6-24,.pure-u-sm-7-12,.pure-u-sm-7-24,.pure-u-sm-7-8,.pure-u-sm-8-24,.pure-u-sm-9-24{display:inline-block;zoom:1;letter-spacing:normal;word-spacing:normal;vertical-align:top;text-rendering:auto}.pure-u-sm-1-24{width:4.1667%}.pure-u-sm-1-12,.pure-u-sm-2-24{width:8.3333%}.pure-u-sm-1-8,.pure-u-sm-3-24{width:12.5%}.pure-u-sm-1-6,.pure-u-sm-4-24{width:16.6667%}.pure-u-sm-1-5{width:20%}.pure-u-sm-5-24{width:20.8333%}.pure-u-sm-1-4,.pure-u-sm-6-24{width:25%}.pure-u-sm-7-24{width:29.1667%}.pure-u-sm-1-3,.pure-u-sm-8-24{width:33.3333%}.pure-u-sm-3-8,.pure-u-sm-9-24{width:37.5%}.pure-u-sm-2-5{width:40%}.pure-u-sm-10-24,.pure-u-sm-5-12{width:41.6667%}.pure-u-sm-11-24{width:45.8333%}.pure-u-sm-1-2,.pure-u-sm-12-24{width:50%}.pure-u-sm-13-24{width:54.1667%}.pure-u-sm-14-24,.pure-u-sm-7-12{width:58.3333%}.pure-u-sm-3-5{width:60%}.pure-u-sm-15-24,.pure-u-sm-5-8{width:62.5%}.pure-u-sm-16-24,.pure-u-sm-2-3{width:66.6667%}.pure-u-sm-17-24{width:70.8333%}.pure-u-sm-18-24,.pure-u-sm-3-4{width:75%}.pure-u-sm-19-24{width:79.1667%}.pure-u-sm-4-5{width:80%}.pure-u-sm-20-24,.pure-u-sm-5-6{width:83.3333%}.pure-u-sm-21-24,.pure-u-sm-7-8{width:87.5%}.pure-u-sm-11-12,.pure-u-sm-22-24{width:91.6667%}.pure-u-sm-23-24{width:95.8333%}.pure-u-sm-1,.pure-u-sm-1-1,.pure-u-sm-24-24,.pure-u-sm-5-5{width:100%}}@media screen and (min-width:48em){.pure-u-md-1,.pure-u-md-1-1,.pure-u-md-1-12,.pure-u-md-1-2,.pure-u-md-1-24,.pure-u-md-1-3,.pure-u-md-1-4,.pure-u-md-1-5,.pure-u-md-1-6,.pure-u-md-1-8,.pure-u-md-10-24,.pure-u-md-11-12,.pure-u-md-11-24,.pure-u-md-12-24,.pure-u-md-13-24,.pure-u-md-14-24,.pure-u-md-15-24,.pure-u-md-16-24,.pure-u-md-17-24,.pure-u-md-18-24,.pure-u-md-19-24,.pure-u-md-2-24,.pure-u-md-2-3,.pure-u-md-2-5,.pure-u-md-20-24,.pure-u-md-21-24,.pure-u-md-22-24,.pure-u-md-23-24,.pure-u-md-24-24,.pure-u-md-3-24,.pure-u-md-3-4,.pure-u-md-3-5,.pure-u-md-3-8,.pure-u-md-4-24,.pure-u-md-4-5,.pure-u-md-5-12,.pure-u-md-5-24,.pure-u-md-5-5,.pure-u-md-5-6,.pure-u-md-5-8,.pure-u-md-6-24,.pure-u-md-7-12,.pure-u-md-7-24,.pure-u-md-7-8,.pure-u-md-8-24,.pure-u-md-9-24{display:inline-block;zoom:1;letter-spacing:normal;word-spacing:normal;vertical-align:top;text-rendering:auto}.pure-u-md-1-24{width:4.1667%}.pure-u-md-1-12,.pure-u-md-2-24{width:8.3333%}.pure-u-md-1-8,.pure-u-md-3-24{width:12.5%}.pure-u-md-1-6,.pure-u-md-4-24{width:16.6667%}.pure-u-md-1-5{width:20%}.pure-u-md-5-24{width:20.8333%}.pure-u-md-1-4,.pure-u-md-6-24{width:25%}.pure-u-md-7-24{width:29.1667%}.pure-u-md-1-3,.pure-u-md-8-24{width:33.3333%}.pure-u-md-3-8,.pure-u-md-9-24{width:37.5%}.pure-u-md-2-5{width:40%}.pure-u-md-10-24,.pure-u-md-5-12{width:41.6667%}.pure-u-md-11-24{width:45.8333%}.pure-u-md-1-2,.pure-u-md-12-24{width:50%}.pure-u-md-13-24{width:54.1667%}.pure-u-md-14-24,.pure-u-md-7-12{width:58.3333%}.pure-u-md-3-5{width:60%}.pure-u-md-15-24,.pure-u-md-5-8{width:62.5%}.pure-u-md-16-24,.pure-u-md-2-3{width:66.6667%}.pure-u-md-17-24{width:70.8333%}.pure-u-md-18-24,.pure-u-md-3-4{width:75%}.pure-u-md-19-24{width:79.1667%}.pure-u-md-4-5{width:80%}.pure-u-md-20-24,.pure-u-md-5-6{width:83.3333%}.pure-u-md-21-24,.pure-u-md-7-8{width:87.5%}.pure-u-md-11-12,.pure-u-md-22-24{width:91.6667%}.pure-u-md-23-24{width:95.8333%}.pure-u-md-1,.pure-u-md-1-1,.pure-u-md-24-24,.pure-u-md-5-5{width:100%}}@media screen and (min-width:64em){.pure-u-lg-1,.pure-u-lg-1-1,.pure-u-lg-1-12,.pure-u-lg-1-2,.pure-u-lg-1-24,.pure-u-lg-1-3,.pure-u-lg-1-4,.pure-u-lg-1-5,.pure-u-lg-1-6,.pure-u-lg-1-8,.pure-u-lg-10-24,.pure-u-lg-11-12,.pure-u-lg-11-24,.pure-u-lg-12-24,.pure-u-lg-13-24,.pure-u-lg-14-24,.pure-u-lg-15-24,.pure-u-lg-16-24,.pure-u-lg-17-24,.pure-u-lg-18-24,.pure-u-lg-19-24,.pure-u-lg-2-24,.pure-u-lg-2-3,.pure-u-lg-2-5,.pure-u-lg-20-24,.pure-u-lg-21-24,.pure-u-lg-22-24,.pure-u-lg-23-24,.pure-u-lg-24-24,.pure-u-lg-3-24,.pure-u-lg-3-4,.pure-u-lg-3-5,.pure-u-lg-3-8,.pure-u-lg-4-24,.pure-u-lg-4-5,.pure-u-lg-5-12,.pure-u-lg-5-24,.pure-u-lg-5-5,.pure-u-lg-5-6,.pure-u-lg-5-8,.pure-u-lg-6-24,.pure-u-lg-7-12,.pure-u-lg-7-24,.pure-u-lg-7-8,.pure-u-lg-8-24,.pure-u-lg-9-24{display:inline-block;zoom:1;letter-spacing:normal;word-spacing:normal;vertical-align:top;text-rendering:auto}.pure-u-lg-1-24{width:4.1667%}.pure-u-lg-1-12,.pure-u-lg-2-24{width:8.3333%}.pure-u-lg-1-8,.pure-u-lg-3-24{width:12.5%}.pure-u-lg-1-6,.pure-u-lg-4-24{width:16.6667%}.pure-u-lg-1-5{width:20%}.pure-u-lg-5-24{width:20.8333%}.pure-u-lg-1-4,.pure-u-lg-6-24{width:25%}.pure-u-lg-7-24{width:29.1667%}.pure-u-lg-1-3,.pure-u-lg-8-24{width:33.3333%}.pure-u-lg-3-8,.pure-u-lg-9-24{width:37.5%}.pure-u-lg-2-5{width:40%}.pure-u-lg-10-24,.pure-u-lg-5-12{width:41.6667%}.pure-u-lg-11-24{width:45.8333%}.pure-u-lg-1-2,.pure-u-lg-12-24{width:50%}.pure-u-lg-13-24{width:54.1667%}.pure-u-lg-14-24,.pure-u-lg-7-12{width:58.3333%}.pure-u-lg-3-5{width:60%}.pure-u-lg-15-24,.pure-u-lg-5-8{width:62.5%}.pure-u-lg-16-24,.pure-u-lg-2-3{width:66.6667%}.pure-u-lg-17-24{width:70.8333%}.pure-u-lg-18-24,.pure-u-lg-3-4{width:75%}.pure-u-lg-19-24{width:79.1667%}.pure-u-lg-4-5{width:80%}.pure-u-lg-20-24,.pure-u-lg-5-6{width:83.3333%}.pure-u-lg-21-24,.pure-u-lg-7-8{width:87.5%}.pure-u-lg-11-12,.pure-u-lg-22-24{width:91.6667%}.pure-u-lg-23-24{width:95.8333%}.pure-u-lg-1,.pure-u-lg-1-1,.pure-u-lg-24-24,.pure-u-lg-5-5{width:100%}}@media screen and (min-width:80em){.pure-u-xl-1,.pure-u-xl-1-1,.pure-u-xl-1-12,.pure-u-xl-1-2,.pure-u-xl-1-24,.pure-u-xl-1-3,.pure-u-xl-1-4,.pure-u-xl-1-5,.pure-u-xl-1-6,.pure-u-xl-1-8,.pure-u-xl-10-24,.pure-u-xl-11-12,.pure-u-xl-11-24,.pure-u-xl-12-24,.pure-u-xl-13-24,.pure-u-xl-14-24,.pure-u-xl-15-24,.pure-u-xl-16-24,.pure-u-xl-17-24,.pure-u-xl-18-24,.pure-u-xl-19-24,.pure-u-xl-2-24,.pure-u-xl-2-3,.pure-u-xl-2-5,.pure-u-xl-20-24,.pure-u-xl-21-24,.pure-u-xl-22-24,.pure-u-xl-23-24,.pure-u-xl-24-24,.pure-u-xl-3-24,.pure-u-xl-3-4,.pure-u-xl-3-5,.pure-u-xl-3-8,.pure-u-xl-4-24,.pure-u-xl-4-5,.pure-u-xl-5-12,.pure-u-xl-5-24,.pure-u-xl-5-5,.pure-u-xl-5-6,.pure-u-xl-5-8,.pure-u-xl-6-24,.pure-u-xl-7-12,.pure-u-xl-7-24,.pure-u-xl-7-8,.pure-u-xl-8-24,.pure-u-xl-9-24{display:inline-block;zoom:1;letter-spacing:normal;word-spacing:normal;vertical-align:top;text-rendering:auto}.pure-u-xl-1-24{width:4.1667%}.pure-u-xl-1-12,.pure-u-xl-2-24{width:8.3333%}.pure-u-xl-1-8,.pure-u-xl-3-24{width:12.5%}.pure-u-xl-1-6,.pure-u-xl-4-24{width:16.6667%}.pure-u-xl-1-5{width:20%}.pure-u-xl-5-24{width:20.8333%}.pure-u-xl-1-4,.pure-u-xl-6-24{width:25%}.pure-u-xl-7-24{width:29.1667%}.pure-u-xl-1-3,.pure-u-xl-8-24{width:33.3333%}.pure-u-xl-3-8,.pure-u-xl-9-24{width:37.5%}.pure-u-xl-2-5{width:40%}.pure-u-xl-10-24,.pure-u-xl-5-12{width:41.6667%}.pure-u-xl-11-24{width:45.8333%}.pure-u-xl-1-2,.pure-u-xl-12-24{width:50%}.pure-u-xl-13-24{width:54.1667%}.pure-u-xl-14-24,.pure-u-xl-7-12{width:58.3333%}.pure-u-xl-3-5{width:60%}.pure-u-xl-15-24,.pure-u-xl-5-8{width:62.5%}.pure-u-xl-16-24,.pure-u-xl-2-3{width:66.6667%}.pure-u-xl-17-24{width:70.8333%}.pure-u-xl-18-24,.pure-u-xl-3-4{width:75%}.pure-u-xl-19-24{width:79.1667%}.pure-u-xl-4-5{width:80%}.pure-u-xl-20-24,.pure-u-xl-5-6{width:83.3333%}.pure-u-xl-21-24,.pure-u-xl-7-8{width:87.5%}.pure-u-xl-11-12,.pure-u-xl-22-24{width:91.6667%}.pure-u-xl-23-24{width:95.8333%}.pure-u-xl-1,.pure-u-xl-1-1,.pure-u-xl-24-24,.pure-u-xl-5-5{width:100%}}
  </style>
  

  
  <style type="text/css" media="screen">
    html {
	min-height:100%;
	width:100%;
	position:relative;
}

body {
	background-color: rgb(252,252,252);
	color: #484848;
}

.nav-menu {
  margin-top: 5px;
  padding-bottom: 5px;
	border-bottom: 1px solid #e3e3e3;
}

.pure-menu-heading {
  text-transform: none;
  font-size: large;
}

.header {
	text-align: left;
	color: #484848;
	margin-bottom: .5em;
}

.header ul li {
		height: auto;
}

.header ul li a {
	font-weight: bold;
	color: #484848;
	font-family: "Source Sans Pro", "HelveticaNeue", "Helvetica Neue", Helvetica, Arial, sans-serif;
}

.header {
	font-weight: bold;
	color: #484848;
	font-family: "Source Sans Pro", "HelveticaNeue", "Helvetica Neue", Helvetica, Arial, sans-serif;
}

.site-title {
	color: #484848;
  text-transform: none;
  font-weight: normal;
	font-family: "Source Sans Pro", "HelveticaNeue", "Helvetica Neue", Helvetica, Arial, sans-serif;
}

.pull-right {
	float: right;
}

.posts-name {
	text-transform: capitalize;
	font-weight: bold;
	padding-left: 1em;
	margin-top: 1em;
	font-family: "Source Sans Pro", "HelveticaNeue", "Helvetica Neue", Helvetica, Arial, sans-serif;
}

.posts {
	font-family: verdana,arial,helvetica,sans-serif;
	list-style-type:none;
	padding-left: 1em;
}

.posts li p {
	margin-top: 0;
}

.posts li {
	margin-bottom: 1em;
}

.posts li a {
	color:#369;
	text-decoration:none;
}

.post-list {
  font-size: large;
}

.footnote {
	font-family: verdana,arial,helvetica,sans-serif;
	color:#888;
	font-size:x-small;
	margin-bottom:0;
}

.footnote a {
	color: #888 !important
}

.footnote a:hover{
	text-decoration:underline;
	color:#369;
}

.footer {
	position:absolute;
	z-index:2;
	height:auto;
	width:100%;
	bottom:0;
}

.footer-content {
	border-top: 1px solid #e3e3e3;
	font-size: 80%;
	color: #bbb;
}

.footer-content a {
	color: #bbb;
}

.footer-content ul {
	height: auto;
	margin-top: 0;
	margin-bottom: 0;
	display: inline-block;
	padding-left: 0;
}

#gototop-btn {
	display: inline-block;
}

#foot-name {
  color: #484848;
	text-transform: none;
}

#foot-copyright {
	padding-left: 1em;
	padding-bottom: 0.5em;
	margin: 0;
}

.post {
	font-family: proxima-nova,"Helvetica Neue",Helvetica,Roboto,Arial,sans-serif;
	color:#484848;
	letter-spacing:normal;
	padding-left: .5em;
}

.post h1,h2,h3,h4,h5,h6 {
	font-weight: bold;
	letter-spacing:normal;
}

.post-content {
	z-index:9;
	overflow:auto;
	padding:0;
	padding-bottom:3em;
	font-size:16px;
	line-height:1.4;
}

.post-content img {
	max-width: 100%;
	height: auto;
}

/* these sections screw up other themes */ 
/*.post-content code {
  background-color: #EEE;
}

.post code {
  background-color: #EEE;
} */
/* to here */

.post a {
	color:#c05b4d;
	text-decoration: none;
}

.post a:hover {
	color:#a5473a;
	text-decoration: underline;
}

.post h1 {
	font-size:28px;
}

.post h2 {
	font-size:25px;
}

.post h3 {
	font-size:23px;
}

.post h4 {
	font-size:21px;
}

.post h5 {
	font-size:19px;
}

.post h6 {
	font-size:18px;
}

.post-title{
		margin-top: 0;
		margin-bottom: 2em;
}

.post-title h1 {
	font-weight:bold;
	font-size:39px;
	line-height: 40px;
	margin-top: 0;
	margin-bottom: 0;
}

@media screen and (max-width:767px){
	.desktop {
		display: none;
	}
	.mobile {
		display: block;
	}
	#toggle-btn {
		display: inline-block;
		float: right;
		padding: .5em 1em;
		text-decoration: none;
		color: #484848;
		font-weight: bold;
	}
	#toggle-content li {
		clear: both;
		height: auto;
		background-color: rgb(249,249,249);
	}
	#toggle-home {
		display: inline-block;
	}
}

@media screen and (min-width:768px){
	.mobile {
		display:none;
	}
	.desktop {
		display: block;
	}
}

  </style>
  
  <style type="text/css" media="screen"> 
    
      /*

Zenburn style from voldmar.ru (c) Vladimir Epifanov <voldmar@voldmar.ru>
based on dark.css by Ivan Sagalaev

*/

.hljs {
  display: block;
  overflow-x: auto;
  padding: 0.5em;
  background: #3f3f3f;
  color: #dcdcdc;
}

.hljs-keyword,
.hljs-selector-tag,
.hljs-tag {
  color: #e3ceab;
}

.hljs-template-tag {
  color: #dcdcdc;
}

.hljs-number {
  color: #8cd0d3;
}

.hljs-variable,
.hljs-template-variable,
.hljs-attribute {
  color: #efdcbc;
}

.hljs-literal {
  color: #efefaf;
}

.hljs-subst {
  color: #8f8f8f;
}

.hljs-title,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-section,
.hljs-type {
  color: #efef8f;
}

.hljs-symbol,
.hljs-bullet,
.hljs-link {
  color: #dca3a3;
}

.hljs-deletion,
.hljs-string,
.hljs-built_in,
.hljs-builtin-name {
  color: #cc9393;
}

.hljs-addition,
.hljs-comment,
.hljs-quote,
.hljs-meta {
  color: #7f9f7f;
}


.hljs-emphasis {
  font-style: italic;
}

.hljs-strong {
  font-weight: bold;
}
 
    
  </style>
  

  
  <link rel="shortcut icon" 
   
    href="/img/favicon.ico"
  
  type="image/x-icon">

  
  

  <meta name="generator" content="Hugo 0.40.3" />

  
  
</head>
<body>

<div class="header pure-g">
    <div class="pure-u-1-24 pure-u-md-1-6"></div>
    <div class="pure-u-11-12 pure-u-md-2-3">
        <div class="desktop pure-menu pure-menu-horizontal nav-menu">
            
            <a href="/" class="site-title pure-menu-heading">Electronic Lab Notebook</a>
            <ul class="pure-menu-list pull-right">
				
                
                <li class="pure-menu-item">
                    <a href="/categories/coding" class="pure-menu-link">Coding</a>
                </li>
                
                <li class="pure-menu-item">
                    <a href="/categories/experiments" class="pure-menu-link">Experiments</a>
                </li>
                
                <li class="pure-menu-item">
                    <a href="/categories/reading" class="pure-menu-link">Reading</a>
                </li>
                
				
                <li class="pure-menu-item">
                    <a href="/about/" class="pure-menu-link">About</a>
                </li>
            </ul>
        </div>
        <div class="mobile pure-menu nav-menu">
            <a href="/" class="site-title pure-menu-heading" id="toggle-home">Electronic Lab Notebook</a>
            <a href="#" id="toggle-btn">&#9776;</a>
            <ul class="pure-menu-list" id="toggle-content" style="display:none;">
                
				
                
                <li class="pure-menu-item">
                    <a href="/categories/coding" class="pure-menu-link">Coding</a>
                </li>
                
                <li class="pure-menu-item">
                    <a href="/categories/experiments" class="pure-menu-link">Experiments</a>
                </li>
                
                <li class="pure-menu-item">
                    <a href="/categories/reading" class="pure-menu-link">Reading</a>
                </li>
                
				
                <li class="pure-menu-item">
                    <a href="/about" class="pure-menu-link">About</a>
                </li>
            </ul>
        </div>
    </div>
    <div class="pure-u-1-24 pure-u-md-1-6"></div>
</div>


<div class="pure-g">
  <div class="pure-u-1-24 pure-u-md-1-6"></div>
  <div class="pure-u-11-12 pure-u-md-2-3">
    <div class="post">

      <div class="post-title">
        <p class="footnote">
        <time class="">09-19-2018</time>
        
        
        |
        
        
        tags: [ <a href="/tags/gaston">Gaston</a> <a href="/tags/gcta">GCTA</a> <a href="/tags/genomic-data">Genomic Data</a> <a href="/tags/gwas">GWAS</a> <a href="/tags/heritability">Heritability</a> <a href="/tags/mlma">MLMA</a> ]
        

        
        categories: [<a href="/categories/experiments">Experiments</a> <a href="/categories/coding">Coding</a> ]
        

        
        </p>
        <h1>SNP heritability</h1>
      </div>

      <div class="post-content">
        <div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>SNP heritability of index SNPs are non-sense. The numbers I am obtaining are either too high or too low.</p>
</div>
<div id="methods-and-results" class="section level1">
<h1>Methods and Results</h1>
<pre class="r"><code>require(magrittr)
require(dplyr)
require(gaston)
require(qqman)</code></pre>
<div id="load-relevant-data" class="section level3">
<h3>Load relevant data</h3>
<pre class="r"><code>nies_heritable_pheno &lt;- read.csv(&#39;C:/Users/Martha/Documents/Honours/Project/honours.project/Data/nies_heritable_pheno.csv&#39;, header = T)

merged_nies_210818 &lt;- read.bed.matrix(&quot;C:/Users/Martha/Documents/Honours/Project/honours.project/Data/merged_nies/merged_nies_geno_210818.bed&quot;)</code></pre>
<pre><code>## Reading C:/Users/Martha/Documents/Honours/Project/honours.project/Data/merged_nies/merged_nies_geno_210818.fam 
## Reading C:/Users/Martha/Documents/Honours/Project/honours.project/Data/merged_nies/merged_nies_geno_210818.bim 
## Reading C:/Users/Martha/Documents/Honours/Project/honours.project/Data/merged_nies/merged_nies_geno_210818.bed 
## ped stats and snps stats have been set. 
## &#39;p&#39; has been set. 
## &#39;mu&#39; and &#39;sigma&#39; have been set.</code></pre>
<pre class="r"><code>merged_nies_GRM &lt;- GRM(merged_nies_210818)
merged_nies_eiK &lt;- eigen(merged_nies_GRM)
merged_nies_eiK$values[ merged_nies_eiK$values &lt; 0] &lt;- 0
merged_nies_PC &lt;- sweep(merged_nies_eiK$vectors, 2, sqrt(merged_nies_eiK$values), &quot;*&quot;)</code></pre>
<div id="gwas-using-lmm-and-lrt" class="section level4">
<h4>1. GWAS using lmm and lrt</h4>
<pre class="r"><code>l_KvalH_gwas &lt;- association.test(merged_nies_210818, nies_heritable_pheno$L.K.value.H, method=&quot;lmm&quot;, test = &quot;lrt&quot;, response = &quot;quantitative&quot;, K = merged_nies_GRM, eigenK = merged_nies_eiK, p = 2)
l_KvalH_gwas &lt;- na.omit(l_KvalH_gwas)
l_kvalH_filtered &lt;- l_KvalH_gwas %&gt;% filter(-log10(p)&gt;1) %&gt;% filter(freqA2 &lt; 0.99)
l_kvalH_meff &lt;- l_kvalH_filtered %&gt;% filter(p &lt; 1.84e-7)
l_kvalH_sig &lt;- do.call(rbind, lapply(split(l_kvalH_meff,l_kvalH_meff$chr), function(x) {return(x[which.min(x$p),])}))

l_kvalH_res &lt;- NULL
for (i in l_kvalH_sig$id) {
  snpID &lt;- i
  snpCHR &lt;- l_kvalH_filtered[l_kvalH_filtered$id == snpID,]$chr
  snpPOS &lt;- l_kvalH_filtered[l_kvalH_filtered$id ==snpID,]$pos
  
  sig.peak &lt;- l_kvalH_filtered %&gt;%
    filter(chr == snpCHR) %&gt;%
    filter(pos &gt; snpPOS - 50000) %&gt;%
    filter(pos &lt; snpPOS + 50000) %&gt;%
    filter(p &lt; 1e-5)
  
  l_kvalH_res &lt;- rbind(l_kvalH_res, sig.peak)
}

l_kvalH_res</code></pre>
<pre><code>##    chr      pos          id A1 A2    freqA2         h2      LRT
## 1    2 32321350 rs148319856  C  A 0.9826087 0.22244002 33.29515
## 2    2 32367072 rs115270434  C  A 0.9855072 0.17567169 20.65630
## 3    3 77739700   rs1163757  A  G 0.9869565 0.03021585 32.17915
## 4    6 82442490 rs114928787  T  C 0.9855072 0.00000000 43.16564
## 5    6 82442833 rs116172930  C  A 0.9855072 0.00000000 43.16564
## 6    6 82443802  rs74436554  C  T 0.9855072 0.00000000 43.16564
## 7    6 82444791  rs78056249  C  G 0.9855072 0.00000000 43.16564
## 8    6 82445716  rs77941466  C  T 0.9855072 0.00000000 43.16564
## 9    6 82447004 rs116461493  T  C 0.9855072 0.00000000 43.16564
## 10   6 82447732  rs77666578  G  A 0.9855072 0.00000000 43.16564
## 11   6 82451563  rs75189229  A  G 0.9855072 0.00000000 43.16564
## 12   6 82453938 rs117178778  A  G 0.9855072 0.00000000 43.16564
## 13   6 82454058 rs116246536  T  G 0.9855072 0.00000000 43.16564
## 14   6 82454140  rs78427866  A  G 0.9855072 0.00000000 43.16564
## 15   6 82454380 rs147257041  A  G 0.9855072 0.00000000 43.16564
## 16   6 82454449 rs140711073  T  C 0.9855072 0.00000000 43.16564
## 17   6 82454505 rs142248448  T  C 0.9855072 0.00000000 43.16564
## 18   6 82454620 rs114442506  A  G 0.9855072 0.00000000 43.16564
## 19   6 82456537 rs145558293  A  G 0.9855072 0.00000000 43.16564
## 20   6 82458393  rs77391407  C  T 0.9855072 0.00000000 43.16564
## 21   6 82458546  rs77103853  G  C 0.9855072 0.00000000 43.16564
## 22   6 82459011 rs115096710  T  C 0.9855072 0.00000000 43.16564
## 23   6 82459713  rs77245672  G  C 0.9855072 0.00000000 43.16564
## 24   6 82459810  rs77599496  T  A 0.9855072 0.00000000 43.16564
## 25   6 82459890  rs77598967  G  A 0.9855072 0.00000000 43.16564
## 26   6 82460167 rs115847999  C  G 0.9855072 0.00000000 43.16564
## 27   6 82460379 rs116730626  G  A 0.9855072 0.00000000 43.16564
## 28   6 82460650 rs149355051  G  T 0.9855072 0.00000000 43.16564
## 29   6 82462126  rs76856243  T  C 0.9855072 0.00000000 43.16564
## 30   6 82462603   rs6933239  C  T 0.9855072 0.00000000 43.16564
## 31   6 82462992   rs6911216  A  C 0.9855072 0.00000000 43.16564
## 32   6 82465617   rs6928806  A  C 0.9855072 0.00000000 43.16564
## 33   6 82466574  rs74404091  C  T 0.9855072 0.00000000 43.16564
## 34   6 82466715  rs79358384  G  A 0.9855072 0.00000000 43.16564
## 35   6 82467200  rs77721025  A  C 0.9855072 0.00000000 43.16564
## 36   6 82467706 rs116423281  A  G 0.9855072 0.00000000 43.16564
## 37   6 82467953 rs142216660  T  C 0.9855072 0.00000000 43.16564
## 38   6 82467988 rs140099919  A  G 0.9855072 0.00000000 43.16564
## 39   6 82468668  rs78941585  G  A 0.9855072 0.00000000 43.16564
## 40   6 82468774  rs75228268  A  T 0.9855072 0.00000000 43.16564
## 41   6 82469116  rs77552654  T  A 0.9855072 0.00000000 43.16564
## 42   6 82470649 rs149706908  G  T 0.9855072 0.00000000 43.16564
## 43   6 82470651 rs144623191  T  C 0.9855072 0.00000000 43.16564
## 44   6 82470859 rs192614396  C  A 0.9855072 0.00000000 43.16564
## 45   6 82471119 rs151156468  C  T 0.9855072 0.00000000 43.16564
## 46   6 82471338 rs140554533  A  G 0.9855072 0.00000000 43.16564
## 47   6 82471381 rs150446760  C  G 0.9855072 0.00000000 43.16564
## 48   6 82471679 rs138339145  T  C 0.9855072 0.00000000 43.16564
## 49   6 82472140 rs142089466  T  C 0.9855072 0.00000000 43.16564
## 50   6 82473676 rs147151928  G  C 0.9855072 0.00000000 43.16564
## 51   6 82473679 rs140298049  C  T 0.9855072 0.00000000 43.16564
## 52   6 82473688 rs149655171  A  G 0.9855072 0.00000000 43.16564
## 53   6 82474468 rs146864360  T  C 0.9855072 0.00000000 43.16564
## 54   6 82474648 rs140520501  C  T 0.9855072 0.00000000 43.16564
## 55   6 82474867 rs150394443  T  C 0.9855072 0.00000000 43.16564
## 56   6 82475320 rs143579868  A  T 0.9855072 0.00000000 43.16564
## 57   6 82475696 rs115741750  C  T 0.9855072 0.00000000 43.16564
## 58   6 82477810  rs77406497  T  C 0.9855072 0.00000000 43.16564
## 59   6 82478378 rs115813741  T  G 0.9855072 0.00000000 43.16564
## 60   6 82478650  rs78900243  G  A 0.9855072 0.00000000 43.16564
## 61   6 82478870  rs76557363  T  G 0.9855072 0.00000000 43.16564
## 62   6 82479264  rs77943130  T  G 0.9855072 0.00000000 43.16564
## 63   6 82479546 rs115245280  A  G 0.9855072 0.00000000 43.16564
## 64   6 82479664  rs75910615  A  G 0.9855072 0.00000000 43.16564
## 65   6 82480370  rs76438934  A  G 0.9855072 0.00000000 43.16564
## 66   6 82481986 rs115034961  A  C 0.9855072 0.00000000 43.16564
## 67   6 82482183  rs79967481  G  A 0.9855072 0.00000000 43.16564
## 68   6 82482254 rs116699765  T  C 0.9855072 0.00000000 43.16564
## 69   6 82483125  rs78639250  T  C 0.9855072 0.00000000 43.16564
## 70   6 82483522  rs75763492  A  G 0.9855072 0.00000000 43.16564
## 71   6 82483898  rs76617768  T  C 0.9855072 0.00000000 43.16564
## 72   6 82484287  rs76652063  C  A 0.9855072 0.00000000 43.16564
## 73   6 82484758 rs114024754  A  G 0.9855072 0.00000000 43.16564
## 74   6 82485370  rs79031996  C  G 0.9855072 0.00000000 43.16564
## 75   6 82485916  rs77517398  C  T 0.9855072 0.00000000 43.16564
## 76   6 82486863  rs80252551  A  T 0.9855072 0.00000000 43.16564
## 77   6 82488997 rs114963095  G  T 0.9855072 0.00000000 43.16564
## 78   6 82489053  rs77561386  C  T 0.9855072 0.00000000 43.16564
## 79   6 82489164  rs76602861  A  G 0.9855072 0.00000000 43.16564
## 80   6 82490178  rs79435750  A  G 0.9855072 0.00000000 43.16564
## 81   6 82490367  rs80347071  C  G 0.9855072 0.00000000 43.16564
## 82   6 82492170  rs74785531  C  T 0.9855072 0.00000000 43.16564
## 83   6 82492233  rs74361967  C  T 0.9855072 0.00000000 43.16564
## 84   6 82492321  rs75373608  A  T 0.9855072 0.00000000 43.16564
## 85  10 64099069  rs74804993  G  A 0.9826087 0.27726310 31.54649
## 86  16 13935176   rs1800067  A  G 0.9550725 0.29435196 33.85516
##               p
## 1  7.917990e-09
## 2  5.495605e-06
## 3  1.405911e-08
## 4  5.029621e-11
## 5  5.029621e-11
## 6  5.029621e-11
## 7  5.029621e-11
## 8  5.029621e-11
## 9  5.029621e-11
## 10 5.029621e-11
## 11 5.029621e-11
## 12 5.029621e-11
## 13 5.029621e-11
## 14 5.029621e-11
## 15 5.029621e-11
## 16 5.029621e-11
## 17 5.029621e-11
## 18 5.029621e-11
## 19 5.029621e-11
## 20 5.029621e-11
## 21 5.029621e-11
## 22 5.029621e-11
## 23 5.029621e-11
## 24 5.029621e-11
## 25 5.029621e-11
## 26 5.029621e-11
## 27 5.029621e-11
## 28 5.029621e-11
## 29 5.029621e-11
## 30 5.029621e-11
## 31 5.029621e-11
## 32 5.029621e-11
## 33 5.029621e-11
## 34 5.029621e-11
## 35 5.029621e-11
## 36 5.029621e-11
## 37 5.029621e-11
## 38 5.029621e-11
## 39 5.029621e-11
## 40 5.029621e-11
## 41 5.029621e-11
## 42 5.029621e-11
## 43 5.029621e-11
## 44 5.029621e-11
## 45 5.029621e-11
## 46 5.029621e-11
## 47 5.029621e-11
## 48 5.029621e-11
## 49 5.029621e-11
## 50 5.029621e-11
## 51 5.029621e-11
## 52 5.029621e-11
## 53 5.029621e-11
## 54 5.029621e-11
## 55 5.029621e-11
## 56 5.029621e-11
## 57 5.029621e-11
## 58 5.029621e-11
## 59 5.029621e-11
## 60 5.029621e-11
## 61 5.029621e-11
## 62 5.029621e-11
## 63 5.029621e-11
## 64 5.029621e-11
## 65 5.029621e-11
## 66 5.029621e-11
## 67 5.029621e-11
## 68 5.029621e-11
## 69 5.029621e-11
## 70 5.029621e-11
## 71 5.029621e-11
## 72 5.029621e-11
## 73 5.029621e-11
## 74 5.029621e-11
## 75 5.029621e-11
## 76 5.029621e-11
## 77 5.029621e-11
## 78 5.029621e-11
## 79 5.029621e-11
## 80 5.029621e-11
## 81 5.029621e-11
## 82 5.029621e-11
## 83 5.029621e-11
## 84 5.029621e-11
## 85 1.947216e-08
## 86 5.937145e-09</code></pre>
<pre class="r"><code>manhattan(x = l_kvalH_filtered, chr = &quot;chr&quot;, bp = &quot;pos&quot;, p = &quot;p&quot;, snp = &quot;id&quot;, ylim = c(0,12), genomewideline = -log10(1.84e-7), main = &quot;L K-value H (LRT)&quot;, annotatePval = 1.84e-7)</code></pre>
<p><img src="/posts/2018-09-19-snp-heritability_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
</div>
<div id="gwas-using-lm-and-wald" class="section level4">
<h4>2. GWAS using lm and wald</h4>
<pre class="r"><code>l_KvalH_wald &lt;- association.test(merged_nies_210818, nies_heritable_pheno$L.K.value.H, method=&quot;lm&quot;, test = &quot;wald&quot;, K = merged_nies_GRM, eigenK = merged_nies_eiK, p = 2)
l_KvalH_wald &lt;- na.omit(l_KvalH_wald)
l_kvalH_Wfilt &lt;- l_KvalH_wald %&gt;% filter(-log10(p)&gt;1) %&gt;% filter(freqA2 &lt; 0.99)
l_kvalH_Wmeff &lt;- l_kvalH_Wfilt %&gt;% filter(p &lt; 1.84e-7)
l_kvalH_Wsig &lt;- do.call(rbind, lapply(split(l_kvalH_Wmeff,l_kvalH_Wmeff$chr), function(x) {return(x[which.min(x$p),])}))

l_kvalH_Wres &lt;- NULL
for (i in l_kvalH_sig$id) {
  snpID &lt;- i
  snpCHR &lt;- l_kvalH_Wfilt[l_kvalH_Wfilt$id == snpID,]$chr
  snpPOS &lt;- l_kvalH_Wfilt[l_kvalH_Wfilt$id ==snpID,]$pos
  
  sig.peak &lt;- l_kvalH_Wfilt %&gt;%
    filter(chr == snpCHR) %&gt;%
    filter(pos &gt; snpPOS - 50000) %&gt;%
    filter(pos &lt; snpPOS + 50000) %&gt;%
    filter(p &lt; 1e-5)
  
  l_kvalH_Wres &lt;- rbind(l_kvalH_Wres, sig.peak)
}

l_kvalH_Wres</code></pre>
<pre><code>##    chr      pos          id A1 A2    freqA2     beta        sd
## 1    2 32321350 rs148319856  C  A 0.9826087 2.792557 0.4665010
## 2    2 32367072 rs115270434  C  A 0.9855072 2.480528 0.5178888
## 3    3 77739700   rs1163757  A  G 0.9869565 3.221804 0.5333681
## 4    6 82425908  rs73481987  C  T 0.9753623 1.917424 0.4054810
## 5    6 82442490 rs114928787  T  C 0.9855072 3.173559 0.4545536
## 6    6 82442833 rs116172930  C  A 0.9855072 3.173559 0.4545536
## 7    6 82443802  rs74436554  C  T 0.9855072 3.173559 0.4545536
## 8    6 82444791  rs78056249  C  G 0.9855072 3.173559 0.4545536
## 9    6 82445716  rs77941466  C  T 0.9855072 3.173559 0.4545536
## 10   6 82447004 rs116461493  T  C 0.9855072 3.173559 0.4545536
## 11   6 82447732  rs77666578  G  A 0.9855072 3.173559 0.4545536
## 12   6 82451563  rs75189229  A  G 0.9855072 3.173559 0.4545536
## 13   6 82453938 rs117178778  A  G 0.9855072 3.173559 0.4545536
## 14   6 82454058 rs116246536  T  G 0.9855072 3.173559 0.4545536
## 15   6 82454140  rs78427866  A  G 0.9855072 3.173559 0.4545536
## 16   6 82454380 rs147257041  A  G 0.9855072 3.173559 0.4545536
## 17   6 82454449 rs140711073  T  C 0.9855072 3.173559 0.4545536
## 18   6 82454505 rs142248448  T  C 0.9855072 3.173559 0.4545536
## 19   6 82454620 rs114442506  A  G 0.9855072 3.173559 0.4545536
## 20   6 82456537 rs145558293  A  G 0.9855072 3.173559 0.4545536
## 21   6 82458393  rs77391407  C  T 0.9855072 3.173559 0.4545536
## 22   6 82458546  rs77103853  G  C 0.9855072 3.173559 0.4545536
## 23   6 82459011 rs115096710  T  C 0.9855072 3.173559 0.4545536
## 24   6 82459713  rs77245672  G  C 0.9855072 3.173559 0.4545536
## 25   6 82459810  rs77599496  T  A 0.9855072 3.173559 0.4545536
## 26   6 82459890  rs77598967  G  A 0.9855072 3.173559 0.4545536
## 27   6 82460167 rs115847999  C  G 0.9855072 3.173559 0.4545536
## 28   6 82460379 rs116730626  G  A 0.9855072 3.173559 0.4545536
## 29   6 82460650 rs149355051  G  T 0.9855072 3.173559 0.4545536
## 30   6 82462126  rs76856243  T  C 0.9855072 3.173559 0.4545536
## 31   6 82462603   rs6933239  C  T 0.9855072 3.173559 0.4545536
## 32   6 82462992   rs6911216  A  C 0.9855072 3.173559 0.4545536
## 33   6 82465617   rs6928806  A  C 0.9855072 3.173559 0.4545536
## 34   6 82466574  rs74404091  C  T 0.9855072 3.173559 0.4545536
## 35   6 82466715  rs79358384  G  A 0.9855072 3.173559 0.4545536
## 36   6 82467200  rs77721025  A  C 0.9855072 3.173559 0.4545536
## 37   6 82467706 rs116423281  A  G 0.9855072 3.173559 0.4545536
## 38   6 82467953 rs142216660  T  C 0.9855072 3.173559 0.4545536
## 39   6 82467988 rs140099919  A  G 0.9855072 3.173559 0.4545536
## 40   6 82468668  rs78941585  G  A 0.9855072 3.173559 0.4545536
## 41   6 82468774  rs75228268  A  T 0.9855072 3.173559 0.4545536
## 42   6 82469116  rs77552654  T  A 0.9855072 3.173559 0.4545536
## 43   6 82470649 rs149706908  G  T 0.9855072 3.173559 0.4545536
## 44   6 82470651 rs144623191  T  C 0.9855072 3.173559 0.4545536
## 45   6 82470859 rs192614396  C  A 0.9855072 3.173559 0.4545536
## 46   6 82471119 rs151156468  C  T 0.9855072 3.173559 0.4545536
## 47   6 82471338 rs140554533  A  G 0.9855072 3.173559 0.4545536
## 48   6 82471381 rs150446760  C  G 0.9855072 3.173559 0.4545536
## 49   6 82471679 rs138339145  T  C 0.9855072 3.173559 0.4545536
## 50   6 82472140 rs142089466  T  C 0.9855072 3.173559 0.4545536
## 51   6 82473676 rs147151928  G  C 0.9855072 3.173559 0.4545536
## 52   6 82473679 rs140298049  C  T 0.9855072 3.173559 0.4545536
## 53   6 82473688 rs149655171  A  G 0.9855072 3.173559 0.4545536
## 54   6 82474468 rs146864360  T  C 0.9855072 3.173559 0.4545536
## 55   6 82474648 rs140520501  C  T 0.9855072 3.173559 0.4545536
## 56   6 82474867 rs150394443  T  C 0.9855072 3.173559 0.4545536
## 57   6 82475320 rs143579868  A  T 0.9855072 3.173559 0.4545536
## 58   6 82475696 rs115741750  C  T 0.9855072 3.173559 0.4545536
## 59   6 82477810  rs77406497  T  C 0.9855072 3.173559 0.4545536
## 60   6 82478378 rs115813741  T  G 0.9855072 3.173559 0.4545536
## 61   6 82478650  rs78900243  G  A 0.9855072 3.173559 0.4545536
## 62   6 82478870  rs76557363  T  G 0.9855072 3.173559 0.4545536
## 63   6 82479264  rs77943130  T  G 0.9855072 3.173559 0.4545536
## 64   6 82479546 rs115245280  A  G 0.9855072 3.173559 0.4545536
## 65   6 82479664  rs75910615  A  G 0.9855072 3.173559 0.4545536
## 66   6 82480370  rs76438934  A  G 0.9855072 3.173559 0.4545536
## 67   6 82481986 rs115034961  A  C 0.9855072 3.173559 0.4545536
## 68   6 82482183  rs79967481  G  A 0.9855072 3.173559 0.4545536
## 69   6 82482254 rs116699765  T  C 0.9855072 3.173559 0.4545536
## 70   6 82483125  rs78639250  T  C 0.9855072 3.173559 0.4545536
## 71   6 82483522  rs75763492  A  G 0.9855072 3.173559 0.4545536
## 72   6 82483898  rs76617768  T  C 0.9855072 3.173559 0.4545536
## 73   6 82484287  rs76652063  C  A 0.9855072 3.173559 0.4545536
## 74   6 82484758 rs114024754  A  G 0.9855072 3.173559 0.4545536
## 75   6 82485370  rs79031996  C  G 0.9855072 3.173559 0.4545536
## 76   6 82485916  rs77517398  C  T 0.9855072 3.173559 0.4545536
## 77   6 82486863  rs80252551  A  T 0.9855072 3.173559 0.4545536
## 78   6 82488997 rs114963095  G  T 0.9855072 3.173559 0.4545536
## 79   6 82489053  rs77561386  C  T 0.9855072 3.173559 0.4545536
## 80   6 82489164  rs76602861  A  G 0.9855072 3.173559 0.4545536
## 81   6 82490178  rs79435750  A  G 0.9855072 3.173559 0.4545536
## 82   6 82490367  rs80347071  C  G 0.9855072 3.173559 0.4545536
## 83   6 82492170  rs74785531  C  T 0.9855072 3.173559 0.4545536
## 84   6 82492233  rs74361967  C  T 0.9855072 3.173559 0.4545536
## 85   6 82492321  rs75373608  A  T 0.9855072 3.173559 0.4545536
## 86  10 64099069  rs74804993  G  A 0.9826087 2.637507 0.4654519
## 87  16 13935176   rs1800067  A  G 0.9550725 1.635103 0.2819104
##               p
## 1  5.442928e-09
## 2  2.495356e-06
## 3  4.020056e-09
## 4  3.311531e-06
## 5  1.530777e-11
## 6  1.530777e-11
## 7  1.530777e-11
## 8  1.530777e-11
## 9  1.530777e-11
## 10 1.530777e-11
## 11 1.530777e-11
## 12 1.530777e-11
## 13 1.530777e-11
## 14 1.530777e-11
## 15 1.530777e-11
## 16 1.530777e-11
## 17 1.530777e-11
## 18 1.530777e-11
## 19 1.530777e-11
## 20 1.530777e-11
## 21 1.530777e-11
## 22 1.530777e-11
## 23 1.530777e-11
## 24 1.530777e-11
## 25 1.530777e-11
## 26 1.530777e-11
## 27 1.530777e-11
## 28 1.530777e-11
## 29 1.530777e-11
## 30 1.530777e-11
## 31 1.530777e-11
## 32 1.530777e-11
## 33 1.530777e-11
## 34 1.530777e-11
## 35 1.530777e-11
## 36 1.530777e-11
## 37 1.530777e-11
## 38 1.530777e-11
## 39 1.530777e-11
## 40 1.530777e-11
## 41 1.530777e-11
## 42 1.530777e-11
## 43 1.530777e-11
## 44 1.530777e-11
## 45 1.530777e-11
## 46 1.530777e-11
## 47 1.530777e-11
## 48 1.530777e-11
## 49 1.530777e-11
## 50 1.530777e-11
## 51 1.530777e-11
## 52 1.530777e-11
## 53 1.530777e-11
## 54 1.530777e-11
## 55 1.530777e-11
## 56 1.530777e-11
## 57 1.530777e-11
## 58 1.530777e-11
## 59 1.530777e-11
## 60 1.530777e-11
## 61 1.530777e-11
## 62 1.530777e-11
## 63 1.530777e-11
## 64 1.530777e-11
## 65 1.530777e-11
## 66 1.530777e-11
## 67 1.530777e-11
## 68 1.530777e-11
## 69 1.530777e-11
## 70 1.530777e-11
## 71 1.530777e-11
## 72 1.530777e-11
## 73 1.530777e-11
## 74 1.530777e-11
## 75 1.530777e-11
## 76 1.530777e-11
## 77 1.530777e-11
## 78 1.530777e-11
## 79 1.530777e-11
## 80 1.530777e-11
## 81 1.530777e-11
## 82 1.530777e-11
## 83 1.530777e-11
## 84 1.530777e-11
## 85 1.530777e-11
## 86 3.102948e-08
## 87 1.512997e-08</code></pre>
<pre class="r"><code>manhattan(x = l_kvalH_Wfilt, chr = &quot;chr&quot;, bp = &quot;pos&quot;, p = &quot;p&quot;, snp = &quot;id&quot;, ylim = c(0,12), genomewideline = -log10(1.84e-7), main = &quot;L K-value H (Wald)&quot;, annotatePval = 1.84e-7)</code></pre>
<p><img src="/posts/2018-09-19-snp-heritability_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="test-gwas-on-r-k-value-v" class="section level4">
<h4>3. Test GWAS on R K-value V</h4>
<pre class="r"><code>r_kvalV_gwas &lt;- association.test(merged_nies_210818, nies_heritable_pheno$R.K.value.V, method=&quot;lmm&quot;, test = &quot;lrt&quot;, response = &quot;quantitative&quot;, K = merged_nies_GRM, eigenK = merged_nies_eiK, p = 2)
r_kvalV_gwas &lt;- na.omit(r_kvalV_gwas)
r_kvalV_filtered &lt;- r_kvalV_gwas %&gt;% filter(-log10(p)&gt;1) %&gt;% filter(freqA2 &lt; 0.99)
r_kvalV_meff &lt;- r_kvalV_filtered %&gt;% filter(p &lt; 1.84e-7)
r_kvalV_sig &lt;- do.call(rbind, lapply(split(r_kvalV_meff,r_kvalV_meff$chr), function(x) {return(x[which.min(x$p),])}))

r_kvalV_res &lt;- NULL
for (i in r_kvalV_sig$id) {
  snpID &lt;- i
  snpCHR &lt;- r_kvalV_filtered[r_kvalV_filtered$id == snpID,]$chr
  snpPOS &lt;- r_kvalV_filtered[r_kvalV_filtered$id ==snpID,]$pos
  
  sig.peak &lt;- r_kvalV_filtered %&gt;%
    filter(chr == snpCHR) %&gt;%
    filter(pos &gt; snpPOS - 50000) %&gt;%
    filter(pos &lt; snpPOS + 50000) %&gt;%
    filter(p &lt; 1e-5)
  
  r_kvalV_res &lt;- rbind(r_kvalV_res, sig.peak)
}

r_kvalV_res</code></pre>
<pre><code>##    chr       pos          id A1 A2    freqA2        h2      LRT
## 1    1 205916566  rs72752923  C  A 0.9782609 0.6943696 24.25721
## 2    1 205916729  rs16830364  G  A 0.9782609 0.6943696 24.25721
## 3    1 205916931  rs60255052  C  T 0.9811594 0.6398584 34.38041
## 4    1 205917041  rs60716530  C  T 0.9782609 0.6943696 24.25721
## 5    1 205917115  rs60644810  G  A 0.9782609 0.6943696 24.25721
## 6    1 205917248  rs35694044  A  T 0.9782609 0.6943696 24.25721
## 7    1 205917652  rs16830370  T  C 0.9782609 0.6943696 24.25721
## 8    1 205918853  rs16856462  C  T 0.9782609 0.6943696 24.25721
## 9    1 205919195  rs16856468  G  A 0.9782609 0.6943696 24.25721
## 10   1 205919303  rs60001177  T  C 0.9782609 0.6943696 24.25721
## 11   1 205919401  rs12723666  A  G 0.9782609 0.6943696 24.25721
## 12   1 205920201  rs16856470  T  C 0.9811594 0.6398584 34.38041
## 13   1 205920404  rs16856473  A  G 0.9811594 0.6398584 34.38041
## 14   1 205922403  rs68189466  G  A 0.9797101 0.6457784 26.64533
## 15   1 205922720  rs35648260  G  T 0.9797101 0.6457784 26.64533
## 16   1 205922775  rs35360452  G  T 0.9797101 0.6457784 26.64533
## 17   1 205925474  rs12727528  A  G 0.9797101 0.6457784 26.64533
## 18   1 205935183   rs1891309  G  A 0.9782609 0.6459447 23.46813
## 19   1 205935330   rs1891310  T  G 0.9782609 0.6459447 23.46813
## 20   1 205936240   rs1473537  T  C 0.9739130 0.6448387 28.29076
## 21   1 205942026  rs72752928  T  C 0.9782609 0.6459447 23.46813
## 22   1 205943691  rs66593238  T  C 0.9782609 0.6459447 23.46813
## 23   1 205944627   rs9438407  T  G 0.9782609 0.6459447 23.46813
## 24   1 205945388  rs12741299  T  C 0.9782609 0.6459447 23.46813
## 25   1 205946647  rs34265780  T  C 0.9782609 0.6459447 23.46813
## 26   4 119362510 rs112314510  A  G 0.9855072 0.6858759 28.47085
## 27   4 119362552 rs111968273  T  A 0.9855072 0.6858759 28.47085
## 28   4 119367677 rs113059419  A  G 0.9869565 0.6769095 30.96024
## 29   4 119372303 rs112760591  G  A 0.9855072 0.6858759 28.47085
## 30   4 119372480 rs111609258  C  G 0.9855072 0.6858759 28.47085
## 31   4 119378224 rs147602981  G  A 0.9855072 0.6858759 28.47085
## 32   4 119381167 rs143847948  A  C 0.9855072 0.6858759 28.47085
## 33   4 119390257 rs113224532  T  C 0.9855072 0.6858759 28.47085
## 34   4 119392279 rs117856633  C  A 0.9855072 0.6858759 28.47085
## 35   4 119398681 rs113825627  C  G 0.9855072 0.6858759 28.47085
## 36   4 119403429 rs112414671  A  G 0.9869565 0.6769095 30.96024
## 37   4 119404439 rs183181597  A  G 0.9855072 0.6858759 28.47085
## 38   4 119404927 rs113317707  C  A 0.9855072 0.6858759 28.47085
## 39   4 119408454 rs184703141  T  C 0.9855072 0.6858759 28.47085
## 40  15  57746156 rs143347058  A  G 0.9898551 0.7970430 28.28088
##               p
## 1  8.429104e-07
## 2  8.429104e-07
## 3  4.532633e-09
## 4  8.429104e-07
## 5  8.429104e-07
## 6  8.429104e-07
## 7  8.429104e-07
## 8  8.429104e-07
## 9  8.429104e-07
## 10 8.429104e-07
## 11 8.429104e-07
## 12 4.532633e-09
## 13 4.532633e-09
## 14 2.444408e-07
## 15 2.444408e-07
## 16 2.444408e-07
## 17 2.444408e-07
## 18 1.270004e-06
## 19 1.270004e-06
## 20 1.043931e-07
## 21 1.270004e-06
## 22 1.270004e-06
## 23 1.270004e-06
## 24 1.270004e-06
## 25 1.270004e-06
## 26 9.511997e-08
## 27 9.511997e-08
## 28 2.633682e-08
## 29 9.511997e-08
## 30 9.511997e-08
## 31 9.511997e-08
## 32 9.511997e-08
## 33 9.511997e-08
## 34 9.511997e-08
## 35 9.511997e-08
## 36 2.633682e-08
## 37 9.511997e-08
## 38 9.511997e-08
## 39 9.511997e-08
## 40 1.049275e-07</code></pre>
<pre class="r"><code>manhattan(x = r_kvalV_filtered, chr = &quot;chr&quot;, bp = &quot;pos&quot;, p = &quot;p&quot;, snp = &quot;id&quot;, ylim = c(0,12), genomewideline = -log10(1.84e-7), main = &quot;R K-value V (LRT)&quot;, annotatePval = 1.84e-7)</code></pre>
<p><img src="/posts/2018-09-19-snp-heritability_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre class="r"><code>r_kvalV_wald &lt;- association.test(merged_nies_210818, nies_heritable_pheno$R.K.value.V, method=&quot;lm&quot;, test = &quot;wald&quot;, K = merged_nies_GRM, eigenK = merged_nies_eiK, p = 2)
r_kvalV_wald &lt;- na.omit(r_kvalV_wald)
r_kvalV_Wfilt &lt;- r_kvalV_wald %&gt;% filter(-log10(p)&gt;1) %&gt;% filter(freqA2 &lt; 0.99)
r_kvalV_Wmeff &lt;- r_kvalV_Wfilt %&gt;% filter(p &lt; 1.84e-7)
r_kvalV_Wsig &lt;- do.call(rbind, lapply(split(r_kvalV_Wmeff,r_kvalV_Wmeff$chr), function(x) {return(x[which.min(x$p),])}))

r_kvalV_Wres &lt;- NULL
for (i in r_kvalV_sig$id) {
  snpID &lt;- i
  snpCHR &lt;- r_kvalV_Wfilt[r_kvalV_Wfilt$id == snpID,]$chr
  snpPOS &lt;- r_kvalV_Wfilt[r_kvalV_Wfilt$id ==snpID,]$pos
  
  sig.peak &lt;- r_kvalV_Wfilt %&gt;%
    filter(chr == snpCHR) %&gt;%
    filter(pos &gt; snpPOS - 50000) %&gt;%
    filter(pos &lt; snpPOS + 50000) %&gt;%
    filter(p &lt; 1e-5)
  
  r_kvalV_Wres &lt;- rbind(r_kvalV_Wres, sig.peak)
}

r_kvalV_Wres</code></pre>
<pre><code>##    chr       pos          id A1 A2    freqA2      beta        sd
## 1    1 205916566  rs72752923  C  A 0.9782609 -2.094536 0.3862347
## 2    1 205916729  rs16830364  G  A 0.9782609 -2.094536 0.3862347
## 3    1 205916931  rs60255052  C  T 0.9811594 -2.694097 0.4018115
## 4    1 205917041  rs60716530  C  T 0.9782609 -2.094536 0.3862347
## 5    1 205917115  rs60644810  G  A 0.9782609 -2.094536 0.3862347
## 6    1 205917248  rs35694044  A  T 0.9782609 -2.094536 0.3862347
## 7    1 205917652  rs16830370  T  C 0.9782609 -2.094536 0.3862347
## 8    1 205918853  rs16856462  C  T 0.9782609 -2.094536 0.3862347
## 9    1 205919195  rs16856468  G  A 0.9782609 -2.094536 0.3862347
## 10   1 205919303  rs60001177  T  C 0.9782609 -2.094536 0.3862347
## 11   1 205919401  rs12723666  A  G 0.9782609 -2.094536 0.3862347
## 12   1 205920201  rs16856470  T  C 0.9811594 -2.694097 0.4018115
## 13   1 205920404  rs16856473  A  G 0.9811594 -2.694097 0.4018115
## 14   1 205922403  rs68189466  G  A 0.9797101 -2.351940 0.3952791
## 15   1 205922720  rs35648260  G  T 0.9797101 -2.351940 0.3952791
## 16   1 205922775  rs35360452  G  T 0.9797101 -2.351940 0.3952791
## 17   1 205925474  rs12727528  A  G 0.9797101 -2.351940 0.3952791
## 18   1 205935183   rs1891309  G  A 0.9782609 -2.205056 0.3855569
## 19   1 205935330   rs1891310  T  G 0.9782609 -2.205056 0.3855569
## 20   1 205936240   rs1473537  T  C 0.9739130 -2.152699 0.3541437
## 21   1 205942026  rs72752928  T  C 0.9782609 -2.205056 0.3855569
## 22   1 205943691  rs66593238  T  C 0.9782609 -2.205056 0.3855569
## 23   1 205944627   rs9438407  T  G 0.9782609 -2.205056 0.3855569
## 24   1 205945388  rs12741299  T  C 0.9782609 -2.205056 0.3855569
## 25   1 205946647  rs34265780  T  C 0.9782609 -2.205056 0.3855569
## 26   4 119362510 rs112314510  A  G 0.9855072 -2.744140 0.4524155
## 27   4 119362552 rs111968273  T  A 0.9855072 -2.744140 0.4524155
## 28   4 119367677 rs113059419  A  G 0.9869565 -2.993797 0.4679999
## 29   4 119372303 rs112760591  G  A 0.9855072 -2.744140 0.4524155
## 30   4 119372480 rs111609258  C  G 0.9855072 -2.744140 0.4524155
## 31   4 119378224 rs147602981  G  A 0.9855072 -2.744140 0.4524155
## 32   4 119381167 rs143847948  A  C 0.9855072 -2.744140 0.4524155
## 33   4 119390257 rs113224532  T  C 0.9855072 -2.744140 0.4524155
## 34   4 119392279 rs117856633  C  A 0.9855072 -2.744140 0.4524155
## 35   4 119398681 rs113825627  C  G 0.9855072 -2.744140 0.4524155
## 36   4 119403429 rs112414671  A  G 0.9869565 -2.993797 0.4679999
## 37   4 119403485 rs185357281  A  G 0.9869565 -2.297196 0.4814120
## 38   4 119404439 rs183181597  A  G 0.9855072 -2.744140 0.4524155
## 39   4 119404927 rs113317707  C  A 0.9855072 -2.744140 0.4524155
## 40   4 119408454 rs184703141  T  C 0.9855072 -2.744140 0.4524155
##               p
## 1  1.112376e-07
## 2  1.112376e-07
## 3  8.376034e-11
## 4  1.112376e-07
## 5  1.112376e-07
## 6  1.112376e-07
## 7  1.112376e-07
## 8  1.112376e-07
## 9  1.112376e-07
## 10 1.112376e-07
## 11 1.112376e-07
## 12 8.376034e-11
## 13 8.376034e-11
## 14 6.649744e-09
## 15 6.649744e-09
## 16 6.649744e-09
## 17 6.649744e-09
## 18 2.341944e-08
## 19 2.341944e-08
## 20 3.245978e-09
## 21 2.341944e-08
## 22 2.341944e-08
## 23 2.341944e-08
## 24 2.341944e-08
## 25 2.341944e-08
## 26 3.493475e-09
## 27 3.493475e-09
## 28 5.227359e-10
## 29 3.493475e-09
## 30 3.493475e-09
## 31 3.493475e-09
## 32 3.493475e-09
## 33 3.493475e-09
## 34 3.493475e-09
## 35 3.493475e-09
## 36 5.227359e-10
## 37 2.712563e-06
## 38 3.493475e-09
## 39 3.493475e-09
## 40 3.493475e-09</code></pre>
<pre class="r"><code>manhattan(x = r_kvalV_Wfilt, chr = &quot;chr&quot;, bp = &quot;pos&quot;, p = &quot;p&quot;, snp = &quot;id&quot;, ylim = c(0,12), genomewideline = -log10(1.84e-7), main = &quot;R K-value V (Wald)&quot;, annotatePval = 1.84e-7)</code></pre>
<p><img src="/posts/2018-09-19-snp-heritability_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<div id="gwas-on-component-3" class="section level4">
<h4>4. GWAS on component 3</h4>
<pre class="r"><code>pc3_gwas &lt;- association.test(merged_nies_210818, nies_heritable_pheno$coord.Dim.3, method=&quot;lmm&quot;, test = &quot;lrt&quot;, K = merged_nies_GRM, eigenK = merged_nies_eiK, p = 2)
pc3_gwas &lt;- na.omit(pc3_gwas)
pc3_filtered &lt;- pc3_gwas %&gt;% filter(-log10(p)&gt;1) %&gt;% filter(freqA2 &lt; 0.99)
pc3_meff &lt;- pc3_filtered %&gt;% filter(p &lt; 1.84e-7)
pc3_sig &lt;- do.call(rbind, lapply(split(pc3_meff,pc3_meff$chr), function(x) {return(x[which.min(x$p),])}))

pc3_res &lt;- NULL
for (i in pc3_sig$id) {
  snpID &lt;- i
  snpCHR &lt;- pc3_filtered[pc3_filtered$id == snpID,]$chr
  snpPOS &lt;- pc3_filtered[pc3_filtered$id ==snpID,]$pos
  
  sig.peak &lt;- pc3_filtered %&gt;%
    filter(chr == snpCHR) %&gt;%
    filter(pos &gt; snpPOS - 50000) %&gt;%
    filter(pos &lt; snpPOS + 50000) %&gt;%
    filter(p &lt; 1e-5)
  
  pc3_res &lt;- rbind(pc3_res, sig.peak)
}

pc3_res</code></pre>
<pre><code>##     chr       pos          id A1 A2    freqA2         h2      LRT
## 1     1 205916566  rs72752923  C  A 0.9782609 0.10018393 32.70563
## 2     1 205916729  rs16830364  G  A 0.9782609 0.10018393 32.70563
## 3     1 205916931  rs60255052  C  T 0.9811594 0.06871623 39.43647
## 4     1 205917041  rs60716530  C  T 0.9782609 0.10018393 32.70563
## 5     1 205917115  rs60644810  G  A 0.9782609 0.10018393 32.70563
## 6     1 205917248  rs35694044  A  T 0.9782609 0.10018393 32.70563
## 7     1 205917652  rs16830370  T  C 0.9782609 0.10018393 32.70563
## 8     1 205918853  rs16856462  C  T 0.9782609 0.10018393 32.70563
## 9     1 205919195  rs16856468  G  A 0.9782609 0.10018393 32.70563
## 10    1 205919303  rs60001177  T  C 0.9782609 0.10018393 32.70563
## 11    1 205919401  rs12723666  A  G 0.9782609 0.10018393 32.70563
## 12    1 205920201  rs16856470  T  C 0.9811594 0.06871623 39.43647
## 13    1 205920404  rs16856473  A  G 0.9811594 0.06871623 39.43647
## 14    1 205922403  rs68189466  G  A 0.9797101 0.07135981 40.62325
## 15    1 205922720  rs35648260  G  T 0.9797101 0.07135981 40.62325
## 16    1 205922775  rs35360452  G  T 0.9797101 0.07135981 40.62325
## 17    1 205925474  rs12727528  A  G 0.9797101 0.07135981 40.62325
## 18    1 205935183   rs1891309  G  A 0.9782609 0.06871632 34.26420
## 19    1 205935330   rs1891310  T  G 0.9782609 0.06871632 34.26420
## 20    1 205936240   rs1473537  T  C 0.9739130 0.10624855 27.50857
## 21    1 205942026  rs72752928  T  C 0.9782609 0.06871632 34.26420
## 22    1 205943691  rs66593238  T  C 0.9782609 0.06871632 34.26420
## 23    1 205944627   rs9438407  T  G 0.9782609 0.06871632 34.26420
## 24    1 205945388  rs12741299  T  C 0.9782609 0.06871632 34.26420
## 25    1 205946647  rs34265780  T  C 0.9782609 0.06871632 34.26420
## 26    2  85686354   rs6759832  C  T 0.9884058 0.14207905 36.56416
## 27    3  42006157  rs71315517  G  C 0.9869565 0.06803235 36.98345
## 28    4 119362510 rs112314510  A  G 0.9855072 0.07448922 41.35203
## 29    4 119362552 rs111968273  T  A 0.9855072 0.07448922 41.35203
## 30    4 119367677 rs113059419  A  G 0.9869565 0.04972603 45.15567
## 31    4 119372303 rs112760591  G  A 0.9855072 0.07448922 41.35203
## 32    4 119372480 rs111609258  C  G 0.9855072 0.07448922 41.35203
## 33    4 119378224 rs147602981  G  A 0.9855072 0.07448922 41.35203
## 34    4 119381167 rs143847948  A  C 0.9855072 0.07448922 41.35203
## 35    4 119390257 rs113224532  T  C 0.9855072 0.07448922 41.35203
## 36    4 119392279 rs117856633  C  A 0.9855072 0.07448922 41.35203
## 37    4 119398681 rs113825627  C  G 0.9855072 0.07448922 41.35203
## 38    4 119403429 rs112414671  A  G 0.9869565 0.04972603 45.15567
## 39    4 119403485 rs185357281  A  G 0.9869565 0.06942631 28.75451
## 40    4 119404439 rs183181597  A  G 0.9855072 0.07448922 41.35203
## 41    4 119404927 rs113317707  C  A 0.9855072 0.07448922 41.35203
## 42    4 119408454 rs184703141  T  C 0.9855072 0.07448922 41.35203
## 43    5  25293191 rs138955515  A  G 0.9855072 0.07868229 31.90296
## 44    5  25300269 rs140158697  C  T 0.9855072 0.07868229 31.90296
## 45    5  25331088 rs114133913  T  A 0.9855072 0.07868229 31.90296
## 46    8  80306741 rs111864836  G  T 0.9884058 0.10992188 30.94734
## 47    8  80306859 rs113627660  G  C 0.9884058 0.10992188 30.94734
## 48    8  80307293   rs7845792  A  G 0.9884058 0.10992188 30.94734
## 49    8  80307388   rs7845575  G  A 0.9869565 0.12264506 24.21587
## 50    8  80307700 rs114654811  C  T 0.9884058 0.10992188 30.94734
## 51    8  80307701 rs115278078  A  T 0.9884058 0.10992188 30.94734
## 52    8  80307837  rs79018076  T  C 0.9884058 0.10992188 30.94734
## 53    8  80308098 rs112501384  G  C 0.9884058 0.10992188 30.94734
## 54    8  80309305  rs11996376  A  G 0.9884058 0.10992188 30.94734
## 55    8  80309598  rs79431653  C  G 0.9884058 0.10992188 30.94734
## 56    8  80309626  rs11996450  T  C 0.9884058 0.10992188 30.94734
## 57    8  80310193  rs60741023  C  G 0.9884058 0.10992188 30.94734
## 58    8  80310485   rs7844286  C  T 0.9884058 0.10992188 30.94734
## 59    8  80310716   rs7844696  A  T 0.9884058 0.10992188 30.94734
## 60    8  80310720   rs7826434  G  A 0.9884058 0.10992188 30.94734
## 61    8  80311242  rs80031189  C  T 0.9884058 0.10992188 30.94734
## 62    8  80311252 rs113823684  A  G 0.9884058 0.10992188 30.94734
## 63    8  80311329 rs142907856  A  G 0.9884058 0.10992188 30.94734
## 64    8  80311457 rs112582272  A  G 0.9884058 0.10992188 30.94734
## 65    8  80311580 rs116773209  G  A 0.9884058 0.10992188 30.94734
## 66    8  80311736 rs113314270  G  T 0.9884058 0.10992188 30.94734
## 67    8  80311838 rs117693425  A  G 0.9884058 0.10992188 30.94734
## 68    8  80312291  rs11988873  C  T 0.9884058 0.10992188 30.94734
## 69    8  80312345  rs11988904  A  T 0.9884058 0.10992188 30.94734
## 70    8  80312623  rs36051398  A  C 0.9884058 0.10992188 30.94734
## 71    8  80313751 rs114426401  T  C 0.9884058 0.10992188 30.94734
## 72    8  80314228  rs74981396  G  A 0.9884058 0.10992188 30.94734
## 73    8  80317028  rs11998344  T  G 0.9884058 0.10992188 30.94734
## 74    8  80317208 rs113244900  C  T 0.9884058 0.10992188 30.94734
## 75    8  80318583  rs57246091  A  G 0.9884058 0.10992188 30.94734
## 76    8  80318643 rs113901603  G  A 0.9884058 0.10992188 30.94734
## 77    8  80319691 rs113718590  A  G 0.9884058 0.10992188 30.94734
## 78    8  80320713  rs11987997  A  G 0.9884058 0.10992188 30.94734
## 79    8  80321002 rs111527437  T  A 0.9884058 0.10992188 30.94734
## 80    8  80321694 rs112815920  G  C 0.9884058 0.10992188 30.94734
## 81    8  80323890  rs11998156  C  A 0.9884058 0.10992188 30.94734
## 82    8  80323964  rs16907573  G  A 0.9884058 0.10992188 30.94734
## 83    8  80324156 rs111257240  C  T 0.9884058 0.10992188 30.94734
## 84    8  80325047 rs113437388  T  C 0.9884058 0.10992188 30.94734
## 85    8  80326033 rs111370206  G  A 0.9884058 0.10992188 30.94734
## 86    8  80326935 rs147955676  A  G 0.9884058 0.10992188 30.94734
## 87    8  80327442   rs7841095  C  T 0.9884058 0.10992188 30.94734
## 88    8  80327549   rs7822828  C  A 0.9884058 0.10992188 30.94734
## 89    8  80327732   rs7823481  C  G 0.9884058 0.10992188 30.94734
## 90    8  80328450  rs11990649  A  G 0.9884058 0.10992188 30.94734
## 91    8  80329801  rs56960849  A  G 0.9884058 0.10992188 30.94734
## 92    8  80330197  rs11995624  C  T 0.9884058 0.10992188 30.94734
## 93    8  80330467   rs7837761  A  G 0.9869565 0.12264506 24.21587
## 94    8  80332180 rs113042618  T  C 0.9884058 0.10992188 30.94734
## 95    8  80332423   rs7001142  G  T 0.9884058 0.10992188 30.94734
## 96    8  80332520   rs6980915  G  A 0.9884058 0.10992188 30.94734
## 97    8  80332901   rs6473220  T  C 0.9884058 0.10992188 30.94734
## 98    8  80332907   rs6473221  A  G 0.9884058 0.10992188 30.94734
## 99    8  80333316   rs7835862  C  T 0.9884058 0.10992188 30.94734
## 100   8  80333340   rs7817696  A  G 0.9884058 0.10992188 30.94734
## 101   8  80333506   rs7817634  T  C 0.9884058 0.10992188 30.94734
## 102   8  80333599  rs57419267  C  T 0.9884058 0.10992188 30.94734
## 103   8  80333823  rs59130219  C  T 0.9884058 0.10992188 30.94734
## 104   8  80334098  rs73691385  T  A 0.9884058 0.10992188 30.94734
## 105   8  80334328   rs7840559  C  T 0.9884058 0.10992188 30.94734
## 106   8  80334334   rs7822177  G  A 0.9884058 0.10992188 30.94734
## 107   8  80334582 rs111631456  A  G 0.9884058 0.10992188 30.94734
## 108   8  80334982  rs58109903  T  C 0.9884058 0.10992188 30.94734
## 109   8  80335583  rs73691388  G  A 0.9884058 0.10992188 30.94734
## 110   8  80336124   rs7837108  T  C 0.9884058 0.10992188 30.94734
## 111   8  80336300   rs7840857  T  G 0.9884058 0.10992188 30.94734
## 112   8  80336310   rs7840861  T  G 0.9884058 0.10992188 30.94734
## 113   8  80337292 rs111888115  T  C 0.9884058 0.10992188 30.94734
## 114   8  80337308  rs56871558  T  C 0.9884058 0.10992188 30.94734
## 115   8  80337408  rs56116331  A  G 0.9884058 0.10992188 30.94734
## 116   8  80337443  rs58592997  T  C 0.9884058 0.10992188 30.94734
## 117   8  80337629  rs76783901  A  G 0.9884058 0.10992188 30.94734
## 118   8  80337634  rs74468856  G  A 0.9884058 0.10992188 30.94734
## 119   8  80337985  rs73691394  C  A 0.9884058 0.10992188 30.94734
## 120   8  80338076  rs73691395  T  C 0.9884058 0.10992188 30.94734
## 121   8  80338219  rs73691397  C  G 0.9884058 0.10992188 30.94734
## 122   8  80338255  rs73691398  G  A 0.9884058 0.10992188 30.94734
## 123   8  80338835  rs58958046  A  G 0.9884058 0.10992188 30.94734
## 124   8  80338910  rs58786240  C  T 0.9884058 0.10992188 30.94734
## 125   8  80338955  rs76867788  C  T 0.9884058 0.10992188 30.94734
## 126   8  80339017  rs73691399  T  C 0.9884058 0.10992188 30.94734
## 127   8  80339217  rs73691400  C  G 0.9884058 0.10992188 30.94734
## 128   8  80339959  rs61233095  C  A 0.9884058 0.10992188 30.94734
## 129   8  80340238  rs56408864  A  T 0.9884058 0.10992188 30.94734
## 130   8  80340749   rs7826667  A  G 0.9884058 0.10992188 30.94734
## 131   8  80341236   rs7000592  G  C 0.9884058 0.10992188 30.94734
## 132  12   5987972 rs142100550  T  G 0.9884058 0.06670431 28.13313
## 133  14  77833818 rs146124823  G  A 0.9898551 0.14932850 29.35113
##                p
## 1   1.072260e-08
## 2   1.072260e-08
## 3   3.389072e-10
## 4   1.072260e-08
## 5   1.072260e-08
## 6   1.072260e-08
## 7   1.072260e-08
## 8   1.072260e-08
## 9   1.072260e-08
## 10  1.072260e-08
## 11  1.072260e-08
## 12  3.389072e-10
## 13  3.389072e-10
## 14  1.845969e-10
## 15  1.845969e-10
## 16  1.845969e-10
## 17  1.845969e-10
## 18  4.811508e-09
## 19  4.811508e-09
## 20  1.563996e-07
## 21  4.811508e-09
## 22  4.811508e-09
## 23  4.811508e-09
## 24  4.811508e-09
## 25  4.811508e-09
## 26  1.477230e-09
## 27  1.191362e-09
## 28  1.271391e-10
## 29  1.271391e-10
## 30  1.819783e-11
## 31  1.271391e-10
## 32  1.271391e-10
## 33  1.271391e-10
## 34  1.271391e-10
## 35  1.271391e-10
## 36  1.271391e-10
## 37  1.271391e-10
## 38  1.819783e-11
## 39  8.215837e-08
## 40  1.271391e-10
## 41  1.271391e-10
## 42  1.271391e-10
## 43  1.620700e-08
## 44  1.620700e-08
## 45  1.620700e-08
## 46  2.651253e-08
## 47  2.651253e-08
## 48  2.651253e-08
## 49  8.611958e-07
## 50  2.651253e-08
## 51  2.651253e-08
## 52  2.651253e-08
## 53  2.651253e-08
## 54  2.651253e-08
## 55  2.651253e-08
## 56  2.651253e-08
## 57  2.651253e-08
## 58  2.651253e-08
## 59  2.651253e-08
## 60  2.651253e-08
## 61  2.651253e-08
## 62  2.651253e-08
## 63  2.651253e-08
## 64  2.651253e-08
## 65  2.651253e-08
## 66  2.651253e-08
## 67  2.651253e-08
## 68  2.651253e-08
## 69  2.651253e-08
## 70  2.651253e-08
## 71  2.651253e-08
## 72  2.651253e-08
## 73  2.651253e-08
## 74  2.651253e-08
## 75  2.651253e-08
## 76  2.651253e-08
## 77  2.651253e-08
## 78  2.651253e-08
## 79  2.651253e-08
## 80  2.651253e-08
## 81  2.651253e-08
## 82  2.651253e-08
## 83  2.651253e-08
## 84  2.651253e-08
## 85  2.651253e-08
## 86  2.651253e-08
## 87  2.651253e-08
## 88  2.651253e-08
## 89  2.651253e-08
## 90  2.651253e-08
## 91  2.651253e-08
## 92  2.651253e-08
## 93  8.611958e-07
## 94  2.651253e-08
## 95  2.651253e-08
## 96  2.651253e-08
## 97  2.651253e-08
## 98  2.651253e-08
## 99  2.651253e-08
## 100 2.651253e-08
## 101 2.651253e-08
## 102 2.651253e-08
## 103 2.651253e-08
## 104 2.651253e-08
## 105 2.651253e-08
## 106 2.651253e-08
## 107 2.651253e-08
## 108 2.651253e-08
## 109 2.651253e-08
## 110 2.651253e-08
## 111 2.651253e-08
## 112 2.651253e-08
## 113 2.651253e-08
## 114 2.651253e-08
## 115 2.651253e-08
## 116 2.651253e-08
## 117 2.651253e-08
## 118 2.651253e-08
## 119 2.651253e-08
## 120 2.651253e-08
## 121 2.651253e-08
## 122 2.651253e-08
## 123 2.651253e-08
## 124 2.651253e-08
## 125 2.651253e-08
## 126 2.651253e-08
## 127 2.651253e-08
## 128 2.651253e-08
## 129 2.651253e-08
## 130 2.651253e-08
## 131 2.651253e-08
## 132 1.132505e-07
## 133 6.038130e-08</code></pre>
<pre class="r"><code>manhattan(x = pc3_filtered, chr = &quot;chr&quot;, bp = &quot;pos&quot;, p = &quot;p&quot;, snp = &quot;id&quot;, ylim = c(0,12), genomewideline = -log10(1.84e-7), main = &quot;Component 3 (LRT)&quot;, annotatePval = 1.84e-7)</code></pre>
<p><img src="/posts/2018-09-19-snp-heritability_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre class="r"><code>pc3_wald &lt;- association.test(merged_nies_210818, nies_heritable_pheno$coord.Dim.3, method=&quot;lm&quot;, test = &quot;wald&quot;, K = merged_nies_GRM, eigenK = merged_nies_eiK, p = 2)
pc3_wald &lt;- na.omit(pc3_wald)
pc3_Wfilt &lt;- pc3_wald %&gt;% filter(-log10(p)&gt;1) %&gt;% filter(freqA2 &lt; 0.99)
pc3_Wmeff &lt;- pc3_Wfilt %&gt;% filter(p &lt; 1.84e-7)
pc3_Wsig &lt;- do.call(rbind, lapply(split(pc3_Wmeff,pc3_Wmeff$chr), function(x) {return(x[which.min(x$p),])}))

pc3_Wres &lt;- NULL
for (i in pc3_sig$id) {
  snpID &lt;- i
  snpCHR &lt;- pc3_Wfilt[pc3_Wfilt$id == snpID,]$chr
  snpPOS &lt;- pc3_Wfilt[pc3_Wfilt$id ==snpID,]$pos
  
  sig.peak &lt;- pc3_Wfilt %&gt;%
    filter(chr == snpCHR) %&gt;%
    filter(pos &gt; snpPOS - 50000) %&gt;%
    filter(pos &lt; snpPOS + 50000) %&gt;%
    filter(p &lt; 1e-5)
  
  pc3_Wres &lt;- rbind(pc3_Wres, sig.peak)
}

pc3_Wres</code></pre>
<pre><code>##     chr       pos          id A1 A2    freqA2      beta        sd
## 1     1 205916566  rs72752923  C  A 0.9782609 -2.667653 0.4393435
## 2     1 205916729  rs16830364  G  A 0.9782609 -2.667653 0.4393435
## 3     1 205916931  rs60255052  C  T 0.9811594 -3.088674 0.4617708
## 4     1 205917041  rs60716530  C  T 0.9782609 -2.667653 0.4393435
## 5     1 205917115  rs60644810  G  A 0.9782609 -2.667653 0.4393435
## 6     1 205917248  rs35694044  A  T 0.9782609 -2.667653 0.4393435
## 7     1 205917652  rs16830370  T  C 0.9782609 -2.667653 0.4393435
## 8     1 205918853  rs16856462  C  T 0.9782609 -2.667653 0.4393435
## 9     1 205919195  rs16856468  G  A 0.9782609 -2.667653 0.4393435
## 10    1 205919303  rs60001177  T  C 0.9782609 -2.667653 0.4393435
## 11    1 205919401  rs12723666  A  G 0.9782609 -2.667653 0.4393435
## 12    1 205920201  rs16856470  T  C 0.9811594 -3.088674 0.4617708
## 13    1 205920404  rs16856473  A  G 0.9811594 -3.088674 0.4617708
## 14    1 205922403  rs68189466  G  A 0.9797101 -3.038821 0.4478525
## 15    1 205922720  rs35648260  G  T 0.9797101 -3.038821 0.4478525
## 16    1 205922775  rs35360452  G  T 0.9797101 -3.038821 0.4478525
## 17    1 205925474  rs12727528  A  G 0.9797101 -3.038821 0.4478525
## 18    1 205935183   rs1891309  G  A 0.9782609 -2.744145 0.4392695
## 19    1 205935330   rs1891310  T  G 0.9782609 -2.744145 0.4392695
## 20    1 205936240   rs1473537  T  C 0.9739130 -2.288989 0.4100258
## 21    1 205942026  rs72752928  T  C 0.9782609 -2.744145 0.4392695
## 22    1 205943691  rs66593238  T  C 0.9782609 -2.744145 0.4392695
## 23    1 205944627   rs9438407  T  G 0.9782609 -2.744145 0.4392695
## 24    1 205945388  rs12741299  T  C 0.9782609 -2.744145 0.4392695
## 25    1 205946647  rs34265780  T  C 0.9782609 -2.744145 0.4392695
## 26    2  85686354   rs6759832  C  T 0.9884058 -4.239789 0.6711844
## 27    3  42006157  rs71315517  G  C 0.9869565 -3.493108 0.5392500
## 28    4 119362510 rs112314510  A  G 0.9855072 -3.508836 0.5130453
## 29    4 119362552 rs111968273  T  A 0.9855072 -3.508836 0.5130453
## 30    4 119367677 rs113059419  A  G 0.9869565 -3.801920 0.5304818
## 31    4 119372303 rs112760591  G  A 0.9855072 -3.508836 0.5130453
## 32    4 119372480 rs111609258  C  G 0.9855072 -3.508836 0.5130453
## 33    4 119378224 rs147602981  G  A 0.9855072 -3.508836 0.5130453
## 34    4 119381167 rs143847948  A  C 0.9855072 -3.508836 0.5130453
## 35    4 119390257 rs113224532  T  C 0.9855072 -3.508836 0.5130453
## 36    4 119392279 rs117856633  C  A 0.9855072 -3.508836 0.5130453
## 37    4 119398681 rs113825627  C  G 0.9855072 -3.508836 0.5130453
## 38    4 119403429 rs112414671  A  G 0.9869565 -3.801920 0.5304818
## 39    4 119403485 rs185357281  A  G 0.9869565 -3.132726 0.5454914
## 40    4 119404439 rs183181597  A  G 0.9855072 -3.508836 0.5130453
## 41    4 119404927 rs113317707  C  A 0.9855072 -3.508836 0.5130453
## 42    4 119408454 rs184703141  T  C 0.9855072 -3.508836 0.5130453
## 43    5  25293191 rs138955515  A  G 0.9855072 -3.122567 0.5186110
## 44    5  25300269 rs140158697  C  T 0.9855072 -3.122567 0.5186110
## 45    5  25331088 rs114133913  T  A 0.9855072 -3.122567 0.5186110
## 46    8  80306741 rs111864836  G  T 0.9884058 -3.735501 0.6324799
## 47    8  80306859 rs113627660  G  C 0.9884058 -3.735501 0.6324799
## 48    8  80307293   rs7845792  A  G 0.9884058 -3.735501 0.6324799
## 49    8  80307388   rs7845575  G  A 0.9869565 -3.159137 0.6030281
## 50    8  80307700 rs114654811  C  T 0.9884058 -3.735501 0.6324799
## 51    8  80307701 rs115278078  A  T 0.9884058 -3.735501 0.6324799
## 52    8  80307837  rs79018076  T  C 0.9884058 -3.735501 0.6324799
## 53    8  80308098 rs112501384  G  C 0.9884058 -3.735501 0.6324799
## 54    8  80309305  rs11996376  A  G 0.9884058 -3.735501 0.6324799
## 55    8  80309598  rs79431653  C  G 0.9884058 -3.735501 0.6324799
## 56    8  80309626  rs11996450  T  C 0.9884058 -3.735501 0.6324799
## 57    8  80310193  rs60741023  C  G 0.9884058 -3.735501 0.6324799
## 58    8  80310485   rs7844286  C  T 0.9884058 -3.735501 0.6324799
## 59    8  80310716   rs7844696  A  T 0.9884058 -3.735501 0.6324799
## 60    8  80310720   rs7826434  G  A 0.9884058 -3.735501 0.6324799
## 61    8  80311242  rs80031189  C  T 0.9884058 -3.735501 0.6324799
## 62    8  80311252 rs113823684  A  G 0.9884058 -3.735501 0.6324799
## 63    8  80311329 rs142907856  A  G 0.9884058 -3.735501 0.6324799
## 64    8  80311457 rs112582272  A  G 0.9884058 -3.735501 0.6324799
## 65    8  80311580 rs116773209  G  A 0.9884058 -3.735501 0.6324799
## 66    8  80311736 rs113314270  G  T 0.9884058 -3.735501 0.6324799
## 67    8  80311838 rs117693425  A  G 0.9884058 -3.735501 0.6324799
## 68    8  80312291  rs11988873  C  T 0.9884058 -3.735501 0.6324799
## 69    8  80312345  rs11988904  A  T 0.9884058 -3.735501 0.6324799
## 70    8  80312623  rs36051398  A  C 0.9884058 -3.735501 0.6324799
## 71    8  80313751 rs114426401  T  C 0.9884058 -3.735501 0.6324799
## 72    8  80314228  rs74981396  G  A 0.9884058 -3.735501 0.6324799
## 73    8  80317028  rs11998344  T  G 0.9884058 -3.735501 0.6324799
## 74    8  80317208 rs113244900  C  T 0.9884058 -3.735501 0.6324799
## 75    8  80318583  rs57246091  A  G 0.9884058 -3.735501 0.6324799
## 76    8  80318643 rs113901603  G  A 0.9884058 -3.735501 0.6324799
## 77    8  80319691 rs113718590  A  G 0.9884058 -3.735501 0.6324799
## 78    8  80320713  rs11987997  A  G 0.9884058 -3.735501 0.6324799
## 79    8  80321002 rs111527437  T  A 0.9884058 -3.735501 0.6324799
## 80    8  80321694 rs112815920  G  C 0.9884058 -3.735501 0.6324799
## 81    8  80323890  rs11998156  C  A 0.9884058 -3.735501 0.6324799
## 82    8  80323964  rs16907573  G  A 0.9884058 -3.735501 0.6324799
## 83    8  80324156 rs111257240  C  T 0.9884058 -3.735501 0.6324799
## 84    8  80325047 rs113437388  T  C 0.9884058 -3.735501 0.6324799
## 85    8  80326033 rs111370206  G  A 0.9884058 -3.735501 0.6324799
## 86    8  80326935 rs147955676  A  G 0.9884058 -3.735501 0.6324799
## 87    8  80327442   rs7841095  C  T 0.9884058 -3.735501 0.6324799
## 88    8  80327549   rs7822828  C  A 0.9884058 -3.735501 0.6324799
## 89    8  80327732   rs7823481  C  G 0.9884058 -3.735501 0.6324799
## 90    8  80328450  rs11990649  A  G 0.9884058 -3.735501 0.6324799
## 91    8  80329801  rs56960849  A  G 0.9884058 -3.735501 0.6324799
## 92    8  80330197  rs11995624  C  T 0.9884058 -3.735501 0.6324799
## 93    8  80330467   rs7837761  A  G 0.9869565 -3.159137 0.6030281
## 94    8  80332180 rs113042618  T  C 0.9884058 -3.735501 0.6324799
## 95    8  80332423   rs7001142  G  T 0.9884058 -3.735501 0.6324799
## 96    8  80332520   rs6980915  G  A 0.9884058 -3.735501 0.6324799
## 97    8  80332901   rs6473220  T  C 0.9884058 -3.735501 0.6324799
## 98    8  80332907   rs6473221  A  G 0.9884058 -3.735501 0.6324799
## 99    8  80333316   rs7835862  C  T 0.9884058 -3.735501 0.6324799
## 100   8  80333340   rs7817696  A  G 0.9884058 -3.735501 0.6324799
## 101   8  80333506   rs7817634  T  C 0.9884058 -3.735501 0.6324799
## 102   8  80333599  rs57419267  C  T 0.9884058 -3.735501 0.6324799
## 103   8  80333823  rs59130219  C  T 0.9884058 -3.735501 0.6324799
## 104   8  80334098  rs73691385  T  A 0.9884058 -3.735501 0.6324799
## 105   8  80334328   rs7840559  C  T 0.9884058 -3.735501 0.6324799
## 106   8  80334334   rs7822177  G  A 0.9884058 -3.735501 0.6324799
## 107   8  80334582 rs111631456  A  G 0.9884058 -3.735501 0.6324799
## 108   8  80334982  rs58109903  T  C 0.9884058 -3.735501 0.6324799
## 109   8  80335583  rs73691388  G  A 0.9884058 -3.735501 0.6324799
## 110   8  80336124   rs7837108  T  C 0.9884058 -3.735501 0.6324799
## 111   8  80336300   rs7840857  T  G 0.9884058 -3.735501 0.6324799
## 112   8  80336310   rs7840861  T  G 0.9884058 -3.735501 0.6324799
## 113   8  80337292 rs111888115  T  C 0.9884058 -3.735501 0.6324799
## 114   8  80337308  rs56871558  T  C 0.9884058 -3.735501 0.6324799
## 115   8  80337408  rs56116331  A  G 0.9884058 -3.735501 0.6324799
## 116   8  80337443  rs58592997  T  C 0.9884058 -3.735501 0.6324799
## 117   8  80337629  rs76783901  A  G 0.9884058 -3.735501 0.6324799
## 118   8  80337634  rs74468856  G  A 0.9884058 -3.735501 0.6324799
## 119   8  80337985  rs73691394  C  A 0.9884058 -3.735501 0.6324799
## 120   8  80338076  rs73691395  T  C 0.9884058 -3.735501 0.6324799
## 121   8  80338219  rs73691397  C  G 0.9884058 -3.735501 0.6324799
## 122   8  80338255  rs73691398  G  A 0.9884058 -3.735501 0.6324799
## 123   8  80338835  rs58958046  A  G 0.9884058 -3.735501 0.6324799
## 124   8  80338910  rs58786240  C  T 0.9884058 -3.735501 0.6324799
## 125   8  80338955  rs76867788  C  T 0.9884058 -3.735501 0.6324799
## 126   8  80339017  rs73691399  T  C 0.9884058 -3.735501 0.6324799
## 127   8  80339217  rs73691400  C  G 0.9884058 -3.735501 0.6324799
## 128   8  80339959  rs61233095  C  A 0.9884058 -3.735501 0.6324799
## 129   8  80340238  rs56408864  A  T 0.9884058 -3.735501 0.6324799
## 130   8  80340749   rs7826667  A  G 0.9884058 -3.735501 0.6324799
## 131   8  80341236   rs7000592  G  C 0.9884058 -3.735501 0.6324799
## 132  12   5987972 rs142100550  T  G 0.9884058 -3.606900 0.6340382
## 133  14  77833818 rs146124823  G  A 0.9898551 -3.360562 0.5957111
##                p
## 1   3.370520e-09
## 2   3.370520e-09
## 3   9.233125e-11
## 4   3.370520e-09
## 5   3.370520e-09
## 6   3.370520e-09
## 7   3.370520e-09
## 8   3.370520e-09
## 9   3.370520e-09
## 10  3.370520e-09
## 11  3.370520e-09
## 12  9.233125e-11
## 13  9.233125e-11
## 14  5.137812e-11
## 15  5.137812e-11
## 16  5.137812e-11
## 17  5.137812e-11
## 18  1.246023e-09
## 19  1.246023e-09
## 20  4.843124e-08
## 21  1.246023e-09
## 22  1.246023e-09
## 23  1.246023e-09
## 24  1.246023e-09
## 25  1.246023e-09
## 26  8.331221e-10
## 27  3.254345e-10
## 28  3.693930e-11
## 29  3.693930e-11
## 30  4.777543e-12
## 31  3.693930e-11
## 32  3.693930e-11
## 33  3.693930e-11
## 34  3.693930e-11
## 35  3.693930e-11
## 36  3.693930e-11
## 37  3.693930e-11
## 38  4.777543e-12
## 39  2.060641e-08
## 40  3.693930e-11
## 41  3.693930e-11
## 42  3.693930e-11
## 43  4.482416e-09
## 44  4.482416e-09
## 45  4.482416e-09
## 46  8.475295e-09
## 47  8.475295e-09
## 48  8.475295e-09
## 49  2.836489e-07
## 50  8.475295e-09
## 51  8.475295e-09
## 52  8.475295e-09
## 53  8.475295e-09
## 54  8.475295e-09
## 55  8.475295e-09
## 56  8.475295e-09
## 57  8.475295e-09
## 58  8.475295e-09
## 59  8.475295e-09
## 60  8.475295e-09
## 61  8.475295e-09
## 62  8.475295e-09
## 63  8.475295e-09
## 64  8.475295e-09
## 65  8.475295e-09
## 66  8.475295e-09
## 67  8.475295e-09
## 68  8.475295e-09
## 69  8.475295e-09
## 70  8.475295e-09
## 71  8.475295e-09
## 72  8.475295e-09
## 73  8.475295e-09
## 74  8.475295e-09
## 75  8.475295e-09
## 76  8.475295e-09
## 77  8.475295e-09
## 78  8.475295e-09
## 79  8.475295e-09
## 80  8.475295e-09
## 81  8.475295e-09
## 82  8.475295e-09
## 83  8.475295e-09
## 84  8.475295e-09
## 85  8.475295e-09
## 86  8.475295e-09
## 87  8.475295e-09
## 88  8.475295e-09
## 89  8.475295e-09
## 90  8.475295e-09
## 91  8.475295e-09
## 92  8.475295e-09
## 93  2.836489e-07
## 94  8.475295e-09
## 95  8.475295e-09
## 96  8.475295e-09
## 97  8.475295e-09
## 98  8.475295e-09
## 99  8.475295e-09
## 100 8.475295e-09
## 101 8.475295e-09
## 102 8.475295e-09
## 103 8.475295e-09
## 104 8.475295e-09
## 105 8.475295e-09
## 106 8.475295e-09
## 107 8.475295e-09
## 108 8.475295e-09
## 109 8.475295e-09
## 110 8.475295e-09
## 111 8.475295e-09
## 112 8.475295e-09
## 113 8.475295e-09
## 114 8.475295e-09
## 115 8.475295e-09
## 116 8.475295e-09
## 117 8.475295e-09
## 118 8.475295e-09
## 119 8.475295e-09
## 120 8.475295e-09
## 121 8.475295e-09
## 122 8.475295e-09
## 123 8.475295e-09
## 124 8.475295e-09
## 125 8.475295e-09
## 126 8.475295e-09
## 127 8.475295e-09
## 128 8.475295e-09
## 129 8.475295e-09
## 130 8.475295e-09
## 131 8.475295e-09
## 132 2.755790e-08
## 133 3.549908e-08</code></pre>
<pre class="r"><code>manhattan(x = pc3_Wfilt, chr = &quot;chr&quot;, bp = &quot;pos&quot;, p = &quot;p&quot;, snp = &quot;id&quot;, ylim = c(0,12), genomewideline = -log10(1.84e-7), main = &quot;Component 3 (Wald)&quot;, annotatePval = 1.84e-7)</code></pre>
<p><img src="/posts/2018-09-19-snp-heritability_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>Wald test appears to identify more significant SNPs</p>
</div>
<div id="generate-example-q-q-plots." class="section level4">
<h4>5. Generate example Q-Q plots.</h4>
<p>For componenet 3</p>
<pre class="r"><code>pc3_rare_out &lt;- pc3_gwas %&gt;% filter(freqA2 &lt; 0.99)
qqplot.pvalues(pc3_rare_out$p, main = &quot;Component 3 QQ plot of p-values&quot;)</code></pre>
<p><img src="/posts/2018-09-19-snp-heritability_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>For component 3 (Wald)</p>
<pre class="r"><code>qqplot.pvalues(pc3_wald$p)</code></pre>
<p><img src="/posts/2018-09-19-snp-heritability_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>For R K-value V</p>
<pre class="r"><code>qqplot.pvalues(r_kvalV_gwas$p)</code></pre>
<p><img src="/posts/2018-09-19-snp-heritability_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>For R Kvalue V (wald)</p>
<pre class="r"><code>qqplot.pvalues(r_kvalV_wald$p)</code></pre>
<p><img src="/posts/2018-09-19-snp-heritability_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<pre class="r"><code>l_kvalV_gwas &lt;- association.test(merged_nies_210818, nies_heritable_pheno$L.K.value.V, method=&quot;lmm&quot;, test = &quot;lrt&quot;, K = merged_nies_GRM, eigenK = merged_nies_eiK, p = 2)
l_kvalV_gwas &lt;- na.omit(l_kvalV_gwas)
l_kvalV_filtered &lt;- l_kvalV_gwas %&gt;% filter(freqA2 &lt; 0.99)

qqplot.pvalues(l_kvalV_filtered)</code></pre>
<p><img src="/posts/2018-09-19-snp-heritability_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="generate-qq-plots-for-all-manhattan-plots-regardless-of-presence-of-significant-loci" class="section level4">
<h4>6. Generate QQ plots for all manhattan plots regardless of presence of significant loci</h4>
<pre class="r"><code>pheno_qqplot &lt;- NULL
for (i in c(2:ncol(nies_heritable_pheno))){
  pheno_colnames &lt;- colnames(nies_heritable_pheno[i])
  her_pheno_gwas &lt;- association.test(merged_nies_210818, nies_heritable_pheno[,i], method = &quot;lmm&quot;, 
                                     test = &quot;lrt&quot;, K = merged_nies_GRM, eigenK = merged_nies_eiK, p =2)
  her_pheno_gwas &lt;- na.omit(her_pheno_gwas)
  pheno_gwas_filtered &lt;- her_pheno_gwas  %&gt;% filter(freqA2 &lt; 0.99)
  tiff(paste(&#39;C:/Users/Martha/Documents/Honours/Project/honours.project/Data/gwas_plots/&#39;, pheno_colnames, &#39;_qqplot.png&#39;), width = 800, height = 500, res = 150, compression = &#39;lzw&#39;)
  gaston:: qqplot.pvalues(pheno_gwas_filtered$p, main = paste(pheno_colnames))
  dev.off()
}</code></pre>
</div>
</div>
</div>

      </div>
      
      <div class="post-content">
        <div id="disqus_thread"></div>
<script>
(function() {
var d = document, s = d.createElement('script');
s.src = 'https://http-martha-labbook-netlify-com.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

      </div>
      
    </div>
  </div>
  <div class="pure-u-1-24 pure-u-md-1-6"></div>
</div>


<div class="footer pure-g">
  <div class="pure-u-1-24 pure-u-md-1-6"></div>
  <div class="pure-u-11-12 pure-u-md-2-3">
    <div class="footer-content">
      <div class="pure-menu pure-menu-horizontal">
        <ul>
          
          <li class="pure-menu-item" id="foot-name">© Martha Aquino</li>
          

          
          <li class="pure-menu-item">
            <a href="mailto:eunise.aquino@connect.qut.edu.au" class="pure-menu-link">Email</a>
          </li>
          

          
          <li class="pure-menu-item">
            <a href="https://github.com/https://github.com/marthaqut/electronic_lab_notebook" class="pure-menu-link">GitHub</a>
          </li>
          

          

          

        </ul>
        <a href="#" class="pure-menu-link pull-right" id="gototop-btn">↑↑</a>
        
      </div>
      
      <p id="foot-copyright">(c) 2018 -- All rights reserved.</p>
      
    </div>
  </div>
  <div class="pure-u-1-24 pure-u-md-1-6"></div>
</div>



  <script src="/highlight/highlight.min.js"></script>
  
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/go.min.js"></script>
  
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/vim.min.js"></script>
  
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/shell.min.js"></script>
  
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/bash.min.js"></script>
  
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/markdown.min.js"></script>
  
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js"></script>
  
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/python.min.js"></script>
   
  <script>hljs.initHighlighting();</script>


<script type="text/javascript">
  go();
  window.addEventListener('resize', go);
  function go(){
    var d=document.querySelector(".desktop")
    if(document.documentElement.clientWidth > 768) {
      d.style.display="";
    } else {
      d.style.display="none";
    }
  }
</script>
<script type="text/javascript">
  var a=document.querySelector("#toggle-btn"),b=document.querySelector("#toggle-content");a.addEventListener("click",function(){""==b.style.display?(b.style.display="none",a.innerHTML="☰"):(b.style.display="",a.innerHTML="X")});</script>


</body>
</html>



