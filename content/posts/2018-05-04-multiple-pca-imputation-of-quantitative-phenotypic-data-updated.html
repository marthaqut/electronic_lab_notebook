---
title: Multiple PCA Imputation of Quantitative Phenotypic Data  - updated
author: Martha Aquino
date: '2018-05-04'
slug: multiple-pca-imputation-of-quantitative-phenotypic-data-updated
categories:
  - Coding
  - Experiments
tags:
  - Data Cleaning
  - Imputation
  - PCA
  - R
---



<div id="methods-and-results" class="section level2">
<h2>Methods and Results</h2>
<pre class="r"><code>phen.data.age &lt;- read.csv(&#39;C:/Users/Martha/Documents/Honours/Project/honours.project/Data/NIES_master_database-age.csv&#39;)

#include logMAR and base-out prism test values 
phen.data.adults&lt;-phen.data.age[phen.data.age$Age.excel&gt;17,]
quant.variables&lt;- c(&quot;Logmar.VA.Right&quot;, &quot;RVA.with.PH&quot;, &quot;Logmar.VA.Left&quot;, &quot;LVA.with.PH&quot;, &quot;R.Sph..pre.dilate.&quot;, &quot;R.Cyl..pre.dilate.&quot;,
                    &quot;R.Axis..pre.dilate.&quot;, &quot;L.Sph..pre.dilate.&quot;, &quot;L.Cyl..pre.dilate.&quot;, &quot;L.Axis..pre.dilate.&quot;,
                    &quot;R.K.value.H&quot;, &quot;R.K.Value.H.Axis&quot;, &quot;R.K.value.V&quot;, &quot;R.K.value.V.Axis&quot;, &quot;L.K.value.H&quot;,
                    &quot;L.K.value.H.Axis&quot;, &quot;L.K.value.V&quot;, &quot;L.K.value.V.Axis&quot;, &quot;R.Pachimetry&quot;, &quot;L.Pachimetry&quot;, &quot;R.Axial.Length&quot;,
                    &quot;L.Axial.Length&quot;, &quot;AC.Depth.R&quot;, &quot;AC.Depth.L&quot;, &quot;R.IOP.mmHg&quot;, &quot;L.IOP.mmHg&quot;, &quot;CDR.RE&quot;, &quot;CDR.LE&quot;)
quant.data.adults&lt;- phen.data.adults[quant.variables]
summary(quant.data.adults)</code></pre>
<pre><code>##  Logmar.VA.Right     RVA.with.PH      Logmar.VA.Left    
##  Min.   :-0.30000   Min.   :-0.2400   Min.   :-0.30000  
##  1st Qu.:-0.08000   1st Qu.:-0.0600   1st Qu.:-0.10000  
##  Median : 0.02000   Median : 0.0400   Median : 0.02000  
##  Mean   : 0.06608   Mean   : 0.0492   Mean   : 0.06359  
##  3rd Qu.: 0.14000   3rd Qu.: 0.1000   3rd Qu.: 0.13000  
##  Max.   : 2.00000   Max.   : 2.0000   Max.   : 1.70000  
##  NA&#39;s   :3          NA&#39;s   :200       NA&#39;s   :6         
##   LVA.with.PH       R.Sph..pre.dilate. R.Cyl..pre.dilate.
##  Min.   :-0.26000   Min.   :-8.0000    Min.   :-11.0000  
##  1st Qu.:-0.08000   1st Qu.: 0.0000    1st Qu.: -0.7500  
##  Median : 0.04000   Median : 0.5000    Median : -0.5000  
##  Mean   : 0.05562   Mean   : 0.5455    Mean   : -0.6497  
##  3rd Qu.: 0.10000   3rd Qu.: 1.2500    3rd Qu.: -0.2500  
##  Max.   : 1.06000   Max.   : 8.5000    Max.   :  0.0000  
##  NA&#39;s   :204        NA&#39;s   :10         NA&#39;s   :10        
##  R.Axis..pre.dilate. L.Sph..pre.dilate. L.Cyl..pre.dilate.
##  Min.   :  0.00      Min.   :-9.5000    Min.   :-9.7500   
##  1st Qu.: 25.50      1st Qu.: 0.0000    1st Qu.:-0.7500   
##  Median : 85.00      Median : 0.5000    Median :-0.5000   
##  Mean   : 80.23      Mean   : 0.5887    Mean   :-0.6522   
##  3rd Qu.:119.00      3rd Qu.: 1.2500    3rd Qu.:-0.2500   
##  Max.   :180.00      Max.   : 8.0000    Max.   : 0.0000   
##  NA&#39;s   :10          NA&#39;s   :9          NA&#39;s   :9         
##  L.Axis..pre.dilate.  R.K.value.H    R.K.Value.H.Axis  R.K.value.V   
##  Min.   :  0.00      Min.   :36.00   Min.   :  0.00   Min.   :37.00  
##  1st Qu.: 13.00      1st Qu.:42.00   1st Qu.: 42.00   1st Qu.:42.75  
##  Median : 70.00      Median :43.00   Median : 91.00   Median :43.75  
##  Mean   : 72.25      Mean   :42.97   Mean   : 93.74   Mean   :43.80  
##  3rd Qu.:113.00      3rd Qu.:44.00   3rd Qu.:156.00   3rd Qu.:45.00  
##  Max.   :180.00      Max.   :48.25   Max.   :180.00   Max.   :55.00  
##  NA&#39;s   :9           NA&#39;s   :16      NA&#39;s   :16       NA&#39;s   :16     
##  R.K.value.V.Axis  L.K.value.H    L.K.value.H.Axis  L.K.value.V   
##  Min.   :  1.00   Min.   :32.75   Min.   :  0.0    Min.   :39.00  
##  1st Qu.: 62.00   1st Qu.:42.00   1st Qu.: 24.0    1st Qu.:42.81  
##  Median : 89.00   Median :43.00   Median : 88.5    Median :43.75  
##  Mean   : 91.18   Mean   :42.97   Mean   : 87.8    Mean   :43.87  
##  3rd Qu.:127.00   3rd Qu.:44.00   3rd Qu.:147.0    3rd Qu.:44.75  
##  Max.   :180.00   Max.   :47.25   Max.   :180.0    Max.   :52.00  
##  NA&#39;s   :16       NA&#39;s   :15      NA&#39;s   :15       NA&#39;s   :15     
##  L.K.value.V.Axis  R.Pachimetry    L.Pachimetry   R.Axial.Length 
##  Min.   :  0.00   Min.   :428.0   Min.   :424.0   Min.   :20.95  
##  1st Qu.: 65.25   1st Qu.:527.0   1st Qu.:526.0   1st Qu.:22.90  
##  Median : 90.00   Median :546.0   Median :547.0   Median :23.50  
##  Mean   : 92.22   Mean   :546.2   Mean   :546.3   Mean   :23.56  
##  3rd Qu.:119.75   3rd Qu.:570.0   3rd Qu.:568.0   3rd Qu.:24.09  
##  Max.   :180.00   Max.   :656.0   Max.   :658.0   Max.   :27.66  
##  NA&#39;s   :15       NA&#39;s   :14      NA&#39;s   :16      NA&#39;s   :13     
##  L.Axial.Length    AC.Depth.R      AC.Depth.L      R.IOP.mmHg   
##  Min.   :21.29   Min.   :2.090   Min.   :2.000   Min.   : 6.00  
##  1st Qu.:22.87   1st Qu.:3.058   1st Qu.:3.040   1st Qu.:14.00  
##  Median :23.46   Median :3.310   Median :3.280   Median :16.00  
##  Mean   :23.54   Mean   :3.320   Mean   :3.306   Mean   :15.88  
##  3rd Qu.:24.11   3rd Qu.:3.550   3rd Qu.:3.553   3rd Qu.:18.00  
##  Max.   :34.43   Max.   :4.950   Max.   :5.130   Max.   :28.00  
##  NA&#39;s   :13      NA&#39;s   :13      NA&#39;s   :13      NA&#39;s   :2      
##    L.IOP.mmHg        CDR.RE           CDR.LE      
##  Min.   : 8.00   Min.   :0.0000   Min.   :0.0000  
##  1st Qu.:14.00   1st Qu.:0.3000   1st Qu.:0.3000  
##  Median :16.00   Median :0.4000   Median :0.4000  
##  Mean   :16.06   Mean   :0.4057   Mean   :0.4022  
##  3rd Qu.:18.00   3rd Qu.:0.5000   3rd Qu.:0.5000  
##  Max.   :33.00   Max.   :0.9900   Max.   :0.9000  
##  NA&#39;s   :3       NA&#39;s   :19       NA&#39;s   :17</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>duplicate data set</li>
</ol>
<pre class="r"><code>ocular_data &lt;- quant.data.adults</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Convert to double matrix to ensure that all data is ‘numeric’</li>
</ol>
<pre class="r"><code>ocular_data &lt;- as.matrix(ocular_data)</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Perform imputation</li>
</ol>
<pre class="r"><code>require(missMDA)</code></pre>
<pre><code>## Loading required package: missMDA</code></pre>
<pre class="r"><code>require(FactoMineR)</code></pre>
<pre><code>## Loading required package: FactoMineR</code></pre>
<pre class="r"><code>nbdim = estim_ncpPCA(ocular_data, method = &#39;EM&#39;, method.cv=&quot;Kfold&quot;)</code></pre>
<pre><code>## 
  |                                                                       
  |                                                                 |   0%
  |                                                                       
  |=                                                                |   1%
  |                                                                       
  |=                                                                |   2%
  |                                                                       
  |==                                                               |   3%
  |                                                                       
  |===                                                              |   4%
  |                                                                       
  |===                                                              |   5%
  |                                                                       
  |====                                                             |   6%
  |                                                                       
  |=====                                                            |   7%
  |                                                                       
  |=====                                                            |   8%
  |                                                                       
  |======                                                           |   9%
  |                                                                       
  |=======                                                          |  10%
  |                                                                       
  |=======                                                          |  11%
  |                                                                       
  |========                                                         |  12%
  |                                                                       
  |=========                                                        |  13%
  |                                                                       
  |=========                                                        |  14%
  |                                                                       
  |==========                                                       |  15%
  |                                                                       
  |===========                                                      |  16%
  |                                                                       
  |===========                                                      |  17%
  |                                                                       
  |============                                                     |  18%
  |                                                                       
  |============                                                     |  19%
  |                                                                       
  |=============                                                    |  20%
  |                                                                       
  |==============                                                   |  21%
  |                                                                       
  |==============                                                   |  22%
  |                                                                       
  |===============                                                  |  23%
  |                                                                       
  |================                                                 |  24%
  |                                                                       
  |================                                                 |  25%
  |                                                                       
  |=================                                                |  26%
  |                                                                       
  |==================                                               |  27%
  |                                                                       
  |==================                                               |  28%
  |                                                                       
  |===================                                              |  29%
  |                                                                       
  |====================                                             |  30%
  |                                                                       
  |====================                                             |  31%
  |                                                                       
  |=====================                                            |  32%
  |                                                                       
  |======================                                           |  33%
  |                                                                       
  |======================                                           |  34%
  |                                                                       
  |=======================                                          |  35%
  |                                                                       
  |========================                                         |  36%
  |                                                                       
  |========================                                         |  37%
  |                                                                       
  |=========================                                        |  38%
  |                                                                       
  |==========================                                       |  39%
  |                                                                       
  |==========================                                       |  40%
  |                                                                       
  |===========================                                      |  41%
  |                                                                       
  |============================                                     |  42%
  |                                                                       
  |============================                                     |  43%
  |                                                                       
  |=============================                                    |  44%
  |                                                                       
  |==============================                                   |  45%
  |                                                                       
  |==============================                                   |  46%
  |                                                                       
  |===============================                                  |  47%
  |                                                                       
  |================================                                 |  48%
  |                                                                       
  |================================                                 |  49%
  |                                                                       
  |=================================                                |  51%
  |                                                                       
  |=================================                                |  52%
  |                                                                       
  |==================================                               |  53%
  |                                                                       
  |===================================                              |  54%
  |                                                                       
  |===================================                              |  55%
  |                                                                       
  |====================================                             |  56%
  |                                                                       
  |=====================================                            |  57%
  |                                                                       
  |=====================================                            |  58%
  |                                                                       
  |======================================                           |  59%
  |                                                                       
  |=======================================                          |  60%
  |                                                                       
  |=======================================                          |  61%
  |                                                                       
  |========================================                         |  62%
  |                                                                       
  |=========================================                        |  63%
  |                                                                       
  |=========================================                        |  64%
  |                                                                       
  |==========================================                       |  65%
  |                                                                       
  |===========================================                      |  66%
  |                                                                       
  |===========================================                      |  67%
  |                                                                       
  |============================================                     |  68%
  |                                                                       
  |=============================================                    |  69%
  |                                                                       
  |=============================================                    |  70%
  |                                                                       
  |==============================================                   |  71%
  |                                                                       
  |===============================================                  |  72%
  |                                                                       
  |===============================================                  |  73%
  |                                                                       
  |================================================                 |  74%
  |                                                                       
  |=================================================                |  75%
  |                                                                       
  |=================================================                |  76%
  |                                                                       
  |==================================================               |  77%
  |                                                                       
  |===================================================              |  78%
  |                                                                       
  |===================================================              |  79%
  |                                                                       
  |====================================================             |  80%
  |                                                                       
  |=====================================================            |  81%
  |                                                                       
  |=====================================================            |  82%
  |                                                                       
  |======================================================           |  83%
  |                                                                       
  |======================================================           |  84%
  |                                                                       
  |=======================================================          |  85%
  |                                                                       
  |========================================================         |  86%
  |                                                                       
  |========================================================         |  87%
  |                                                                       
  |=========================================================        |  88%
  |                                                                       
  |==========================================================       |  89%
  |                                                                       
  |==========================================================       |  90%
  |                                                                       
  |===========================================================      |  91%
  |                                                                       
  |============================================================     |  92%
  |                                                                       
  |============================================================     |  93%
  |                                                                       
  |=============================================================    |  94%
  |                                                                       
  |==============================================================   |  95%
  |                                                                       
  |==============================================================   |  96%
  |                                                                       
  |===============================================================  |  97%
  |                                                                       
  |================================================================ |  98%
  |                                                                       
  |================================================================ |  99%
  |                                                                       
  |=================================================================| 100%</code></pre>
<pre class="r"><code>nbdim</code></pre>
<pre><code>## $ncp
## [1] 5
## 
## $criterion
##        0        1        2        3        4        5 
## 801729.3 804632.4 799982.2 802808.0 792605.3 783816.9</code></pre>
<pre class="r"><code>res.comp = MIPCA(ocular_data, ncp = nbdim$ncp, nboot = 1000)
png(&#39;indiv_supp_plot.png&#39;, width = 3200, height = 3200, res = 150)
plot.MIPCA(res.comp, choice = &quot;ind.supp&quot;) 
dev.off()</code></pre>
<pre><code>## png 
##   2</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Plot variable factor plot</li>
</ol>
<pre class="r"><code>png(&#39;var_factor_plot.png&#39;, width = 3200, height = 3200, res = 150)
plot.MIPCA(res.comp, choice = &quot;var&quot;) 
dev.off()</code></pre>
<pre><code>## png 
##   2</code></pre>
</div>
<div id="discussion" class="section level2">
<h2>Discussion</h2>
<p>From the variable factor plot, it is apparent that the logMAR with pinhole correction values (RVA and LVA with PH) have a large spread, much more scattered than all the other variables. This indicates a relatively large uncertainty for the imputed values for those variables. From the summary statistics, these variables have around 200 missing values, whereas all other variables only have up to 16 missing values. For this reason, we have decided to exclude these variables from subsequent analyses.</p>
<p>Note: this multiple PCA found five components.</p>
</div>
